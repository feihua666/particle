import{p as v,a as w,r as C}from"./messageManage.c6bc8c77.js";import{d as _,r as f,a as x,b as t,o as A,c as M,e as o,w as n,f as T,F as E}from"./index.ed93255a.js";const R=_({name:"MessageManagePage"}),y=_({...R,setup(V){const d=f(null),u=x({form:{},formComps:v,tableColumns:[{prop:"title",label:"\u6D88\u606F\u6807\u9898",showOverflowTooltip:!0},{prop:"shortContent",label:"\u6D88\u606F\u7B80\u77ED\u5185\u5BB9",showOverflowTooltip:!0},{prop:"content",label:"\u6D88\u606F\u5185\u5BB9",showOverflowTooltip:!0},{prop:"typeDictName",label:"\u6D88\u606F\u5206\u7C7B"},{prop:"sendStatusDictName",label:"\u53D1\u9001\u72B6\u6001"},{prop:"sendUserNickname",label:"\u53D1\u9001\u4EBA"},{prop:"sendAt",label:"\u53D1\u9001\u65F6\u95F4"}]}),s=f({buttonText:"\u67E5\u8BE2",loading:!1,permission:"admin:web:message:pageQuery"}),c=()=>{d.value.refreshData()},D=({pageQuery:e})=>w({...u.form,...e}),g={permission:s.value.permission},F=({row:e,column:l,$index:r})=>{if(r<0)return[];let m={id:e.id},a=e.sendStatusDictValue=="sending"||e.sendStatusDictValue=="sent";return[{txt:"\u7F16\u8F91",text:!0,permission:"admin:web:message:update",disabled:a,disabledReason:a?"\u5DF2\u53D1\u9001\u548C\u53D1\u9001\u4E2D\u7684\u4E0D\u80FD\u7F16\u8F91":null,route:{path:"/admin/MessageManageUpdate",query:m}},{txt:"\u5220\u9664",text:!0,permission:"admin:web:message:delete",methodConfirmText:`\u786E\u5B9A\u8981\u5220\u9664 ${e.name} \u5417\uFF1F`,method(){return C({id:e.id}).then(i=>(c(),Promise.resolve(i)))}}]};return(e,l)=>{const r=t("PtButton"),m=t("PtForm"),a=t("PtButtonGroup"),b=t("el-table-column"),i=t("PtTable"),B=t("PtRouteViewPopover");return A(),M(E,null,[o(m,{form:u.form,method:c,defaultButtonsShow:"submit,reset",submitAttrs:s.value,inline:"",comps:u.formComps},{buttons:n(()=>[o(r,{permission:"admin:web:message:create",route:"/admin/MessageManageAdd"},{default:n(()=>[T("\u6DFB\u52A0")]),_:1})]),_:1},8,["form","submitAttrs","comps"]),o(i,{ref_key:"tableRef",ref:d,"default-expand-all":"",dataMethod:D,onDataMethodDataLoading:l[0]||(l[0]=p=>s.value.loading=p),paginationProps:g,columns:u.tableColumns},{defaultAppend:n(()=>[o(b,{label:"\u64CD\u4F5C",width:"180"},{default:n(({row:p,column:P,$index:h})=>[o(a,{options:F({row:p,column:P,$index:h})},null,8,["options"])]),_:1})]),_:1},8,["columns"]),o(B,{level:3})],64)}}});export{y as default};
