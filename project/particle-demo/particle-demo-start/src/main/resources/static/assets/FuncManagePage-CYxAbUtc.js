import{d as h,r as b,a as B,Z as M,b as n,o as T,c as A,e as o,w as r,f as g,F,$ as R,a0 as y}from"./index-D8BtRcSm.js";import{p as D}from"./funcManage-q7Y2De3a.js";import"./treeQueryComps-CWIG2rsy.js";const N=h({__name:"FuncManagePage",setup(V){const p=b(null),s=B({form:{},formComps:D,tableColumns:M}),m=b({buttonText:"查询",loading:!1,permission:"admin:web:func:pageQuery"}),c=()=>{p.value.refreshData()},_=({pageQuery:t})=>R({...s.form,...t}),P={permission:m.value.permission},x=({row:t,column:e,$index:u})=>{if(u<0)return[];let a={id:t.id},i=[{txt:"添加子级",text:!0,permission:"admin:web:func:create",route:{path:"/admin/funcManageAdd",query:a}},{txt:"编辑",position:"more",text:!0,permission:"admin:web:func:update",route:{path:"/admin/funcManageUpdate",query:a}},{txt:"删除",position:"more",text:!0,permission:"admin:web:func:delete",methodConfirmText:`确定要删除 ${t.name} 吗？`,method(){return y({id:t.id}).then(d=>(c(),Promise.resolve(d)))}}];return t.typeDictValue=="page"&&i.push({txt:"添加Crud",position:"more",text:!0,permission:"admin:web:func:create",route:{path:"/admin/funcManageCrudAdd",query:a}}),i};return(t,e)=>{const u=n("PtButton"),a=n("PtForm"),i=n("PtButtonGroup"),f=n("el-table-column"),d=n("PtTable"),C=n("PtRouteViewPopover");return T(),A(F,null,[o(a,{form:s.form,method:c,defaultButtonsShow:"submit,reset",submitAttrs:m.value,inline:"",comps:s.formComps},{buttons:r(()=>[o(u,{permission:"admin:web:func:create",route:"/admin/funcManageAdd"},{default:r(()=>e[1]||(e[1]=[g("添加")])),_:1}),o(u,{permission:"admin:web:func:create",route:"/admin/funcManageCrudAdd"},{default:r(()=>e[2]||(e[2]=[g("添加Crud")])),_:1})]),_:1},8,["form","submitAttrs","comps"]),o(d,{ref_key:"tableRef",ref:p,"default-expand-all":"",dataMethod:_,onDataMethodDataLoading:e[0]||(e[0]=l=>m.value.loading=l),dataMethodResultHandleConvertToTree:!0,paginationProps:P,columns:s.tableColumns},{defaultAppend:r(()=>[o(f,{label:"操作",width:"220"},{default:r(({row:l,column:v,$index:w})=>[o(i,{options:x({row:l,column:v,$index:w}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),o(C,{level:3})],64)}}});export{N as default};
