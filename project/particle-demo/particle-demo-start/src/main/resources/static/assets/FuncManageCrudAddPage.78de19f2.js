import{d as f,a as E,r as p,ac as I,aa as y,I as D,ad as h,b as g,o as C,h as v,R as A,a8 as q,ae as B}from"./index.7013aad1.js";const T=f({name:"FuncManageCrudAddPage"}),M=f({...T,props:{parentId:{type:String},codePrefix:{type:String},namePrefix:{type:String},permissionPrefix:{type:String},funcGroupId:{type:String},typeDictId:{type:String},componentOf:{type:String},createExtPermission:{type:String},deleteExtPermission:{type:String},updateExtPermission:{type:String},queryPageExtPermission:{type:String},isTree:{type:Boolean,default:!1}},setup(c){const u=c,o=E({form:{codePrefix:u.codePrefix,namePrefix:u.namePrefix,permissionPrefix:u.permissionPrefix,funcGroupId:u.funcGroupId,typeDictId:u.typeDictId,componentOf:u.componentOf},formData:{}}),n=[{codeSuffix:"query",nameSuffix:"\u67E5\u8BE2",permissionSuffix:"pageQuery",treePermissionSuffix:"queryList",extPermission:u.queryPageExtPermission||null},{codeSuffix:"create",nameSuffix:"\u6DFB\u52A0",permissionSuffix:"create",treePermissionSuffix:"queryList",extPermission:u.createExtPermission||null},{codeSuffix:"delete",nameSuffix:"\u5220\u9664",permissionSuffix:"delete",extPermission:u.deleteExtPermission||null},{codeSuffix:"update",nameSuffix:"\u4FEE\u6539",permissionSuffix:"update",treePermissionSuffix:"queryList",extPermission:u.updateExtPermission||null}],d=p([{field:{name:"items",value:n.map(e=>e.nameSuffix)},element:{comp:"PtCheckboxGroup",formItemProps:{label:"\u9879\u76EE",required:!0},compProps:{dataMethod:()=>n,props:{value:"nameSuffix",label:"nameSuffix"},dataMethodResultHandle:S}}},{field:{name:"codePrefix"},element:{comp:"el-input",formItemProps:{label:"\u7F16\u7801\u524D\u7F00",required:!0},compProps:{clearable:!0,placeholder:"\u5982\uFF1Auser_manage_"}}},{field:{name:"namePrefix"},element:{comp:"el-input",formItemProps:{label:"\u540D\u79F0\u524D\u7F00",required:!0},compProps:{clearable:!0,placeholder:"\u5982\uFF1A\u7528\u6237"}}},{field:{name:"permissionPrefix"},element:{comp:"el-input",formItemProps:{label:"\u6743\u9650\u7801\u524D\u7F00",required:!0,tips:"\u6CE8\u610F\u4E00\u822C\u7ED3\u5C3E\u5E26\u5192\u53F7"},compProps:{clearable:!0,placeholder:"\u5982\uFF1Aadmin:web:user:"}}},{field:{name:"funcGroupId",value:""},element:{comp:"PtSelect",formItemProps:{label:"\u529F\u80FD\u5206\u7EC4",required:!0},compProps:{clearable:!0,dataMethod:I}}},{field:{name:"icon",value:"Link"},element:{comp:"el-input",formItemProps:{label:"\u56FE\u6807"},compProps:({form:e})=>{let t="Link";return y[e.icon]&&(t=e.icon),{clearable:!0,placeholder:"\u4EC5\u652F\u6301\u5185\u7F6E\u56FE\u6807\u540D\u79F0",prefixIcon:t}}}},{field:{name:"isDisabled",value:!1},element:{comp:"el-switch",formItemProps:{label:"\u662F\u5426\u7981\u7528"},compProps:{activeText:"\u7981\u7528",inactiveText:"\u542F\u7528"}}},{field:{name:"disabledReason"},element:{comp:"el-input",formItemProps:{label:"\u7981\u7528\u539F\u56E0",required:({form:e})=>e.isDisabled==!0},compProps:{clearable:!0}}},{field:{name:"isShow",value:!0},element:{comp:"el-switch",formItemProps:{label:"\u662F\u5426\u5C55\u793A"},compProps:{activeText:"\u5C55\u793A",inactiveText:"\u9690\u85CF"}}},{field:{name:"parentId"},element:{comp:"PtCascader",formItemProps:{label:"\u7236\u7EA7",required:!0},compProps:{clearable:!0,dataMethod:()=>D({}),dataMethodResultHandleConvertToTree:!0}}},{field:{name:"typeDictId"},element:{comp:"PtDictFrontSelect",formItemProps:{label:"\u7C7B\u578B",required:!0},compProps:{clearable:!0,dictParam:{groupCode:"func_type"},defaultValueItem:e=>e.value=="button"}}},{field:{name:"url"},element:{comp:"el-input",formItemProps:{label:"\u8DEF\u7531",rules:[{validator:(e,t,i)=>{var r;!t&&((r=o.formData.typeDictId)==null?void 0:r.value)=="page"?i(new Error("\u8DEF\u7531\u4E0D\u80FD\u4E3A\u7A7A")):i()},trigger:"blur"}],required:({formData:e})=>{var t;return((t=e.typeDictId)==null?void 0:t.value)=="page"}},compProps:{clearable:!0,placeholder:"\u5982\uFF1A/admin/user/add"}}},{field:{name:"seq",value:10},element:{comp:"el-input-number",formItemProps:{label:"\u6392\u5E8F"},compProps:{clearable:!0}}},{field:{name:"componentOf"},element:{comp:"el-input",formItemProps:{label:"\u5F52\u5C5E\u7EC4\u4EF6",required:!0},compProps:{clearable:!0}}},{field:{name:"remark"},element:{comp:"el-input",formItemProps:{label:"\u63CF\u8FF0"},compProps:{clearable:!0}}}]),P=p({buttonText:"\u786E\u8BA4\u6DFB\u52A0",permission:"admin:web:func:create"}),m=e=>e?e+",":"",x=async e=>{let t=e.items;for(let i=0;i<t.length;i++){let r=A(e);try{delete r.items,delete r.codePrefix,delete r.namePrefix,delete r.permissionPrefix,Reflect.deleteProperty(r,"items"),Reflect.deleteProperty(r,"codePrefix"),Reflect.deleteProperty(r,"namePrefix"),Reflect.deleteProperty(r,"permissionPrefix")}catch{}let a=n.find(s=>s.nameSuffix==t[i]);r.code=e.codePrefix+a.codeSuffix,r.name=e.namePrefix+a.nameSuffix;let l="";u.isTree&&a.treePermissionSuffix&&(l=e.permissionPrefix+a.treePermissionSuffix),r.permissions=m(a.extPermission)+m(l)+(e.permissionPrefix+a.permissionSuffix),await q(r)}},F=()=>{!u.parentId||B({id:u.parentId}).then(e=>{let t=e.data.data;o.form.funcGroupId=t.funcGroupId,o.form.parentId=t.id,o.form.codePrefix=t.code+"_",o.form.namePrefix=t.name,o.form.componentOf=t.componentOf})},b=()=>"\u6DFB\u52A0\u6210\u529F\uFF0C\u8BF7\u5237\u65B0\u6570\u636E\u67E5\u770B";function S({success:e}){return e}return h(()=>{F()}),(e,t)=>{const i=g("PtForm");return C(),v(i,{form:o.form,formData:o.formData,labelWidth:"80",method:x,methodSuccess:b,defaultButtonsShow:"submit,reset",submitAttrs:P.value,buttonsTeleportProps:e.$route.meta.formButtonsTeleportProps,inline:"",layout:[1],comps:d.value},null,8,["form","formData","submitAttrs","buttonsTeleportProps","comps"])}}});export{M as default};
