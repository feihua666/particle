import{i as D,d as P,a as _,r,b as T,o as v,g as M,E as w,G as A}from"./index-BGwvwH0Y.js";import{r as B,b as L}from"./dataconstraintCompItem--U-sf_2C.js";import{a as R}from"./dataObjectAdminApi-DRHTeweL.js";import{a as k}from"./dataScopeAdminApi-C5BLIV3n.js";let f="/admin/web/data_scope_custom_data_rel";const x=a=>D.post(f+"/dataScope/assign/customData",a),J=a=>D.get(f+"/queryCustomDataIdsByDataScopeId",{params:a}),j=P({__name:"DataScopeCustomDataRelManageDataScopeAssignCustomDataPage",props:{...B,dataObjectId:{type:String}},setup(a){let m=(t,e="success")=>{A({showClose:!0,message:t,type:e,showIcon:!0,grouping:!0})};const u=a,s=_({form:{isLazyLoad:!1},formData:{}}),c=r([]),d=r(!1);R({id:u.dataObjectId}).then(t=>{let e=t.data.data;e.customDataUrl||m("数据对象未配置自定义数据url","error");let o=t.data.data.customDataConfigJson,h=t.data.data.isCustomDataLazy,n=t.data.data.customDataTypeDictValue,g=t.data.data.customDataTypeDictName;n&&n!="tree_list"&&m(`数据对象自定义数据交互方式为 ${g},暂不支持，已自动适配为 树形列表`,"warn"),s.form.isLazyLoad=h;let p=null;o&&(p=JSON.parse(o).treeProps);let y=[L({props:u,required:!0}),{field:{name:"checkedDataIds",value:[]},element:{comp:"PtTree",formItemProps:{label:"自定义数据",required:!0},compProps:({form:l})=>({dataInitMethod:({param:I})=>{let i=I.dataScopeId;return i?J({id:i}):{data:[]}},dataInitMethodParam:{dataScopeId:l.dataScopeId},dataMethod:()=>k(e.customDataUrl,{}),dataMethodResultHandleConvertToTree:!0,showCheckbox:!0,props:p})}}];c.value=y,d.value=!0});const C=r({buttonText:"确认",permission:"admin:web:dataScopeCustomDataRel:dataScopeAssignCustomData"}),S=()=>x,b=()=>"分配成功，请刷新数据查看";return(t,e)=>{const o=T("PtForm");return d.value?(v(),M(o,{key:0,form:s.form,formData:s.formData,labelWidth:"80",method:S(),methodSuccess:b,defaultButtonsShow:"submit,reset",submitAttrs:C.value,buttonsTeleportProps:t.$route.meta.formButtonsTeleportProps,inline:"",layout:1,comps:c.value},null,8,["form","formData","method","submitAttrs","buttonsTeleportProps","comps"])):w("",!0)}}});export{j as default};
