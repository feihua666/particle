import{b as h,s as B}from"./openplatformOpenapiCompItem.2376526c.js";import{a as _}from"./openplatformAppCompItem.92b3825d.js";import{a as g}from"./openplatformDocApiAdminApi.62db1c33.js";import{d as F,r as u,a as R,b as O,a$ as P,o as f,c,e as p,b0 as S,h as q,W as w,F as I,aX as y}from"./index.853052ed.js";import"./openplatformAppAdminApi.3351d284.js";const k=F({name:"OpenplatformOpenapiDataQueryPage"}),M=F({...k,setup(x){const n=u(null),l=u(null),i=u(null),e=R({form:{},formComps:[_({label:"\u5E94\u7528",required:!0,valueChange:({form:a,newValue:o})=>{o||(a.openplatformOpenapiId=null)},tips:" 1. \u8BF7\u5148\u9009\u62E9\u8981\u4F7F\u7528\u7684\u5E94\u7528"}),h({fieldName:"openplatformOpenapiId",label:"\u5F00\u653E\u63A5\u53E3",required:!0,disableGroup:!0,valueChange:({form:a,newValue:o})=>{v(o)},tips:" 2. \u8BF7\u9009\u62E9\u8981\u67E5\u8BE2\u7684\u63A5\u53E3"})],dynamicform:{},dynamicformComps:[],dynamicformCompsReady:!1,dynamicformLoading:!1,resultForm:{result:""},resultFormComps:[{field:{name:"result"},element:{comp:"el-input",formItemProps:{label:"\u8C03\u7528\u7ED3\u679C"},compProps:{clearable:!0,type:"textarea",rows:25,readonly:!0,placeholder:"\u8BE5\u533A\u57DF\u663E\u793A\u67E5\u8BE2\u7ED3\u679C\uFF0C\u4E3A\u53EA\u8BFB\u72B6\u6001\uFF0C\u70B9\u51FB\u91CD\u7F6E\u4F1A\u6E05\u7A7A\u8BE5\u533A\u57DF\u6570\u636E"}}}],openplatformDocApiAllDetail:null}),s=u({buttonText:"\u67E5\u8BE2",loading:!1,permission:"admin:web:openplatformOpenapi:singleQuery"}),A=()=>{C(()=>{D(()=>{s.value.loading=!0,b().then(a=>{let o=a.data.data;try{let r=JSON.parse(o),t=JSON.stringify(r,null,"   ");e.resultForm.result=t}catch{e.resultForm.result=o}}).finally(()=>{s.value.loading=!1})})})},C=a=>{n.value&&n.value.formRef.validate((o,r)=>{o&&a()})},D=a=>{l.value&&l.value.formRef.validate((o,r)=>{o&&a()})},b=()=>{let a={bodyParam:null,queryStringParam:null};for(let r in e.form)a[r]=e.form[r];let o={};for(let r in e.dynamicform)o[r]=e.dynamicform[r];return y(o)||(a.bodyParam=o),B(a)},v=a=>{e.dynamicformCompsReady=!1,a&&(e.dynamicformLoading=!0,g({openplatformOpenapiId:a}).then(o=>{e.openplatformDocApiAllDetail=o.data,d()}).catch(o=>{e.openplatformDocApiAllDetail=null,d()}).finally(()=>{e.dynamicformLoading=!1,e.dynamicformCompsReady=!0}))},d=()=>{if(e.dynamicform={},e.dynamicformComps=[],!e.openplatformDocApiAllDetail)return;let a=e.openplatformDocApiAllDetail.data;if(y(a))return;let r=a.docApiDocParamFieldVOsMap.request_param;for(let t=0;t<r.length;t++){let m=r[t];m.parentId||e.dynamicformComps.push({field:{name:m.name},element:{comp:"el-input",formItemProps:{label:m.explanation,required:m.isRequired},compProps:{clearable:!0}}})}},E=()=>{l.value&&l.value.resetForm(),i.value&&i.value.resetForm()};return(a,o)=>{const r=O("PtForm"),t=P("loading");return f(),c(I,null,[p(r,{ref_key:"formRef",ref:n,form:e.form,labelWidth:"120",defaultButtonsShow:"",inline:"",layout:2,comps:e.formComps},null,8,["form","comps"]),S((f(),c("div",null,[e.dynamicformCompsReady?(f(),q(r,{key:0,ref_key:"dynamicFormRef",ref:l,form:e.dynamicform,labelWidth:"120",defaultButtonsShow:"",inline:"",comps:e.dynamicformComps},null,8,["form","comps"])):w("",!0)])),[[t,e.dynamicformLoading]]),p(r,{form:[],labelWidth:"120",method:A,defaultButtonsShow:"submit,reset",submitAttrs:s.value,inline:"",showButtonItem:!0,onResetForm:E,comps:[]},null,8,["submitAttrs"]),p(r,{ref_key:"resultFormRef",ref:i,form:e.resultForm,labelWidth:"80",defaultButtonsShow:"",layout:1,comps:e.resultFormComps},null,8,["form","comps"])],64)}}});export{M as default};
