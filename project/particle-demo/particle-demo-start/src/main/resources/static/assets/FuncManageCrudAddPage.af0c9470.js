import{d as p,a as x,r as i,af as E,ad as I,I as h,ag as D,b as S,o as v,h as C,R as A,ae as y,ah as B}from"./index.5a88179c.js";const _=p({name:"FuncManageCrudAddPage"}),q=p({..._,props:{parentId:{type:String}},setup(s){const m=s,r=x({form:{},formData:{}}),a=[{codeSuffix:"query",nameSuffix:"\u67E5\u8BE2",permissionSuffix:"pageQuery"},{codeSuffix:"create",nameSuffix:"\u6DFB\u52A0",permissionSuffix:"create"},{codeSuffix:"delete",nameSuffix:"\u5220\u9664",permissionSuffix:"delete"},{codeSuffix:"update",nameSuffix:"\u4FEE\u6539",permissionSuffix:"update"}],c=i([{field:{name:"items",value:a.map(e=>e.nameSuffix)},element:{comp:"PtCheckboxGroup",formItemProps:{label:"\u9879\u76EE",required:!0},compProps:{dataMethod:()=>a,props:{value:"nameSuffix",label:"nameSuffix"},dataMethodResultHandle:b}}},{field:{name:"codePrefix"},element:{comp:"el-input",formItemProps:{label:"\u7F16\u7801\u524D\u7F00",required:!0},compProps:{clearable:!0,placeholder:"\u5982\uFF1Auser_manage_"}}},{field:{name:"namePrefix"},element:{comp:"el-input",formItemProps:{label:"\u540D\u79F0\u524D\u7F00",required:!0},compProps:{clearable:!0,placeholder:"\u5982\uFF1A\u7528\u6237"}}},{field:{name:"permissionPrefix"},element:{comp:"el-input",formItemProps:{label:"\u6743\u9650\u7801\u524D\u7F00",required:!0,tips:"\u6CE8\u610F\u4E00\u822C\u7ED3\u5C3E\u5E26\u5192\u53F7"},compProps:{clearable:!0,placeholder:"\u5982\uFF1Aadmin:web:user:"}}},{field:{name:"funcGroupId",value:""},element:{comp:"PtSelect",formItemProps:{label:"\u529F\u80FD\u5206\u7EC4",required:!0},compProps:{clearable:!0,dataMethod:E}}},{field:{name:"icon",value:"Link"},element:{comp:"el-input",formItemProps:{label:"\u56FE\u6807"},compProps:({form:e})=>{let t="Link";return I[e.icon]&&(t=e.icon),{clearable:!0,placeholder:"\u4EC5\u652F\u6301\u5185\u7F6E\u56FE\u6807\u540D\u79F0",prefixIcon:t}}}},{field:{name:"isDisabled",value:!1},element:{comp:"el-switch",formItemProps:{label:"\u662F\u5426\u7981\u7528"},compProps:{activeText:"\u7981\u7528",inactiveText:"\u542F\u7528"}}},{field:{name:"disabledReason"},element:{comp:"el-input",formItemProps:{label:"\u7981\u7528\u539F\u56E0",required:({form:e})=>e.isDisabled==!0},compProps:{clearable:!0}}},{field:{name:"isShow",value:!0},element:{comp:"el-switch",formItemProps:{label:"\u662F\u5426\u5C55\u793A"},compProps:{activeText:"\u5C55\u793A",inactiveText:"\u9690\u85CF"}}},{field:{name:"parentId"},element:{comp:"PtCascader",formItemProps:{label:"\u7236\u7EA7",required:!0},compProps:{clearable:!0,dataMethod:()=>h({}),dataMethodResultHandleConvertToTree:!0}}},{field:{name:"typeDictId"},element:{comp:"PtDictFrontSelect",formItemProps:{label:"\u7C7B\u578B",required:!0},compProps:{clearable:!0,dictParam:{groupCode:"func_type"},defaultValueItem:e=>e.value=="button"}}},{field:{name:"url"},element:{comp:"el-input",formItemProps:{label:"\u8DEF\u7531",rules:[{validator:(e,t,o)=>{var u;!t&&((u=r.formData.typeDictId)==null?void 0:u.value)=="page"?o(new Error("\u8DEF\u7531\u4E0D\u80FD\u4E3A\u7A7A")):o()},trigger:"blur"}],required:({formData:e})=>{var t;return((t=e.typeDictId)==null?void 0:t.value)=="page"}},compProps:{clearable:!0,placeholder:"\u5982\uFF1A/admin/user/add"}}},{field:{name:"seq",value:10},element:{comp:"el-input-number",formItemProps:{label:"\u6392\u5E8F"},compProps:{clearable:!0}}},{field:{name:"componentOf"},element:{comp:"el-input",formItemProps:{label:"\u5F52\u5C5E\u7EC4\u4EF6",required:!0},compProps:{clearable:!0}}},{field:{name:"remark"},element:{comp:"el-input",formItemProps:{label:"\u63CF\u8FF0"},compProps:{clearable:!0}}}]),f=i({buttonText:"\u786E\u8BA4\u6DFB\u52A0",permission:"admin:web:func:create"}),d=async e=>{let t=e.items;for(let o=0;o<t.length;o++){let u=A(e);try{delete u.items,delete u.codePrefix,delete u.namePrefix,delete u.permissionPrefix,Reflect.deleteProperty(u,"items"),Reflect.deleteProperty(u,"codePrefix"),Reflect.deleteProperty(u,"namePrefix"),Reflect.deleteProperty(u,"permissionPrefix")}catch{}let l=a.find(n=>n.nameSuffix==t[o]);u.code=e.codePrefix+l.codeSuffix,u.name=e.namePrefix+l.nameSuffix,u.permissions=e.permissionPrefix+l.permissionSuffix,await y(u)}},P=()=>{!m.parentId||B({id:m.parentId}).then(e=>{let t=e.data.data;r.form.funcGroupId=t.funcGroupId,r.form.parentId=t.id,r.form.codePrefix=t.code+"_",r.form.namePrefix=t.name,r.form.componentOf=t.componentOf})},F=()=>"\u6DFB\u52A0\u6210\u529F\uFF0C\u8BF7\u5237\u65B0\u6570\u636E\u67E5\u770B";function b({success:e}){return e}return D(()=>{P()}),(e,t)=>{const o=S("PtForm");return v(),C(o,{form:r.form,formData:r.formData,labelWidth:"80",method:d,methodSuccess:F,defaultButtonsShow:"submit,reset",submitAttrs:f.value,buttonsTeleportProps:e.$route.meta.formButtonsTeleportProps,inline:"",layout:[1],comps:c.value},null,8,["form","formData","submitAttrs","buttonsTeleportProps","comps"])}}});export{q as default};
