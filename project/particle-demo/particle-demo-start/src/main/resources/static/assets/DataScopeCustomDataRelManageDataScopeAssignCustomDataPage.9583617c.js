import{g as D,d as f,a as B,r as s,b as F,o as I,h as P,W as _,X as T}from"./index.858f5c96.js";import{r as v,b as M}from"./dataconstraintCompItem.19812417.js";import{a as w}from"./dataObjectAdminApi.59ae2d87.js";import{a as L}from"./dataScopeAdminApi.9fbe2fd6.js";let C="/admin/web/data_scope_custom_data_rel";const R=a=>D.post(C+"/dataScope/assign/customData",a),k=a=>D.get(C+"/queryCustomDataIdsByDataScopeId",{params:a}),x=f({name:"DataScopeCustomDataRelManageCustomDataAssignDataScopePage"}),O=f({...x,props:{...v,dataObjectId:{type:String}},setup(a){const r=a;let m=(t,e="success")=>{T({showClose:!0,message:t,type:e,showIcon:!0,grouping:!0})};const u=B({form:{isLazyLoad:!1},formData:{}}),c=s([]),d=s(!1);w({id:r.dataObjectId}).then(t=>{let e=t.data.data;e.customDataUrl||m("\u6570\u636E\u5BF9\u8C61\u672A\u914D\u7F6E\u81EA\u5B9A\u4E49\u6570\u636Eurl","error");let o=t.data.data.customDataConfigJson,h=t.data.data.isCustomDataLazy,n=t.data.data.customDataTypeDictValue,A=t.data.data.customDataTypeDictName;n&&n!="tree_list"&&m(`\u6570\u636E\u5BF9\u8C61\u81EA\u5B9A\u4E49\u6570\u636E\u4EA4\u4E92\u65B9\u5F0F\u4E3A ${A},\u6682\u4E0D\u652F\u6301\uFF0C\u5DF2\u81EA\u52A8\u9002\u914D\u4E3A \u6811\u5F62\u5217\u8868`,"warn"),u.form.isLazyLoad=h;let p=null;o&&(p=JSON.parse(o).treeProps);let g=[M({props:r,required:!0}),{field:{name:"checkedDataIds",value:[]},element:{comp:"PtTree",formItemProps:{label:"\u81EA\u5B9A\u4E49\u6570\u636E",required:!0},compProps:({form:l})=>({dataInitMethod:({param:y})=>{let i=y.dataScopeId;return i?k({id:i}):{data:[]}},dataInitMethodParam:{dataScopeId:l.dataScopeId},dataMethod:()=>L(e.customDataUrl,{}),dataMethodResultHandleConvertToTree:!0,showCheckbox:!0,props:p})}}];c.value=g,d.value=!0});const S=s({buttonText:"\u786E\u8BA4",permission:"admin:web:dataScopeCustomDataRel:dataScopeAssignCustomData"}),E=()=>R,b=()=>"\u5206\u914D\u6210\u529F\uFF0C\u8BF7\u5237\u65B0\u6570\u636E\u67E5\u770B";return(t,e)=>{const o=F("PtForm");return d.value?(I(),P(o,{key:0,form:u.form,formData:u.formData,labelWidth:"80",method:E(),methodSuccess:b,defaultButtonsShow:"submit,reset",submitAttrs:S.value,buttonsTeleportProps:t.$route.meta.formButtonsTeleportProps,inline:"",layout:1,comps:c.value},null,8,["form","formData","method","submitAttrs","buttonsTeleportProps","comps"])):_("",!0)}}});export{O as default};
