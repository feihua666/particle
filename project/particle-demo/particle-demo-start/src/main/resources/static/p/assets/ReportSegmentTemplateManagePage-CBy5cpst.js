import{p as P,r as x,a as S}from"./reportSegmentTemplateAdminApi-DLAdRJYJ.js";import{p as C}from"./reportSegmentTemplateManage-CaegilGI.js";import{d as R,r as f,a as B,b as o,o as O,c as M,e as r,w as p,f as y,F as A}from"./index-B_FSv1tI.js";import"./treeQueryComps-CWIG2rsy.js";import"./reportSegmentTemplateCompItem-B_4pPqIm.js";const q=R({__name:"ReportSegmentTemplateManagePage",setup(D){const d=f(null),n=B({form:{},formComps:C,tableColumns:[{label:"模板名称",prop:"name",showOverflowTooltip:!0,width:250},{label:"编码",prop:"code",showOverflowTooltip:!0},{label:"模板权限码",prop:"permissions",showOverflowTooltip:!0},{label:"输出类型",prop:"outputTypeDictName",showOverflowTooltip:!0},{label:"父级",prop:"parentName"},{label:"计算模板",prop:"computeTemplate",showOverflowTooltip:!0},{label:"名称输出变量名",prop:"nameOutputVariable",showOverflowTooltip:!0},{label:"内容输出变量名",prop:"outputVariable",showOverflowTooltip:!0},{label:"引用模板",prop:"referenceSegmentTemplateName"},{label:"共享变量名",prop:"shareVariables"},{prop:"seq",label:"排序",width:50},{label:"描述",prop:"remark",showOverflowTooltip:!0}]}),l=f({buttonText:"查询",loading:!1,permission:"admin:web:reportSegmentTemplate:pageQuery"}),b=()=>{d.value.refreshData()},T=({pageQuery:e})=>P({...n.form,...e}),g={permission:l.value.permission},h=({row:e,column:a,$index:m})=>{if(m<0)return[];let s={id:e.id},i={id:e.id,parentId:e.parentId};return[{txt:"编辑",text:!0,permission:"admin:web:reportSegmentTemplate:update",route:{path:"/admin/ReportSegmentTemplateManageUpdate",query:s}},{txt:"删除",text:!0,position:"more",permission:"admin:web:reportSegmentTemplate:delete",methodConfirmText:`确定要删除 ${e.name} 吗？`,method(){return x({id:e.id}).then(t=>(b(),Promise.resolve(t)))}},{txt:"复制节点",text:!0,position:"more",permission:"admin:web:reportSegmentTemplate:copy",route:{path:"/admin/reportSegmentTemplateManageCopy",query:i}},{txt:"刷新缓存",text:!0,position:"more",permission:"admin:web:reportSegmentTemplate:refreshCache",methodSuccess:t=>"刷新缓存成功,如果部署多个实例可能要多次执行。 "+t.data.data,method(){return S({id:e.id}).then(t=>Promise.resolve(t))}}]};return(e,a)=>{const m=o("PtButton"),s=o("PtForm"),i=o("PtButtonGroup"),c=o("el-table-column"),t=o("PtTable"),w=o("PtRouteViewPopover");return O(),M(A,null,[r(s,{form:n.form,method:b,defaultButtonsShow:"submit,reset",submitAttrs:l.value,inline:"",comps:n.formComps},{buttons:p(()=>[r(m,{permission:"admin:web:reportSegmentTemplate:create",route:"/admin/ReportSegmentTemplateManageAdd"},{default:p(()=>a[1]||(a[1]=[y("添加")])),_:1})]),_:1},8,["form","submitAttrs","comps"]),r(t,{ref_key:"tableRef",ref:d,"default-expand-all":"",dataMethod:T,onDataMethodDataLoading:a[0]||(a[0]=u=>l.value.loading=u),dataMethodResultHandleConvertToTree:!0,paginationProps:g,columns:n.tableColumns},{defaultAppend:p(()=>[r(c,{label:"操作",width:"180"},{default:p(({row:u,column:_,$index:v})=>[r(i,{options:h({row:u,column:_,$index:v}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),r(w,{level:3})],64)}}});export{q as default};
