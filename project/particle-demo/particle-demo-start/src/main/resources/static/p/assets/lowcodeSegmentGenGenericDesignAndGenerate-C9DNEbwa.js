import{d as C,a as v,r as p,b as d,o as N,c as k,e as c,w,F as S,O as F,G as I,K as R,t as G,R as D}from"./index-B_FSv1tI.js";import{b as j,e as J}from"./lowcodeSegmentGenAdminApi-FJILrCnx.js";const x=C({__name:"LowcodeSegmentGenGenericDesignAndGenerate",props:{lowcodeSegmentGenId:{type:String},formComps:Array,formLayout:{type:[Number,Array]}},setup(a){const e=(m,r="success")=>{I({showClose:!0,message:m,type:r,showIcon:!0,grouping:!0})},o=a,t=v({form:{lowcodeSegmentGenId:o.lowcodeSegmentGenId,javaPackageKeys:["moduleNamePackage","parentPackage"]},renderResultForm:{templateContentResult:"",templateNameContentResult:"",templateNameContentResultFile:""},formData:{}}),l=p(o.formComps),n=p([{field:{name:"templateNameContentResult"},element:{comp:"PtAceEditor",formItemProps:{label:"名称渲染结果文本"},compProps:{clearable:!0,mode:"ace/mode/json",class:"pt-width-100-pc"}}},{field:{name:"templateContentResult"},element:{comp:"PtAceEditor",formItemProps:{label:"渲染结果文本"},compProps:{clearable:!0,mode:"ace/mode/json",class:"pt-width-100-pc"}}},{field:{name:"templateNameContentResultFile"},element:{comp:"el-input",formItemProps:{label:"名称渲染结果文件句柄"},compProps:{clearable:!0}}}]),g=p({buttonText:"开始渲染",permission:"admin:web:lowcodeSegmentGen:renderGen"}),f=m=>{let r=F(m);return r.global&&(r.global=JSON.parse(r.global)),r.ext&&(r.ext=JSON.parse(r.ext)),j(r)},u=p(!1),P=m=>{u.value=!0,t.renderResultForm.templateContentResult=m.data.data.templateContentResult,t.renderResultForm.templateNameContentResult=m.data.data.templateNameContentResult,t.renderResultForm.templateNameContentResultFile=m.data.data.templateNameContentResultFile,setTimeout(()=>{e("渲染成功")},300)};return(m,r)=>{const i=d("PtForm"),y=d("el-dialog");return N(),k(S,null,[c(i,{form:t.form,formData:t.formData,labelWidth:"100",method:f,methodSuccess:P,defaultButtonsShow:"submit,reset",submitAttrs:g.value,buttonsTeleportProps:m.$route.meta.formButtonsTeleportProps,inline:"","label-position":"top",layout:a.formLayout,comps:l.value},null,8,["form","formData","submitAttrs","buttonsTeleportProps","layout","comps"]),c(y,{modelValue:u.value,"onUpdate:modelValue":r[0]||(r[0]=h=>u.value=h),width:"70%",title:"查看渲染结果数据","append-to-body":"","destroy-on-close":""},{default:w(()=>[c(i,{form:t.renderResultForm,labelWidth:"100",defaultButtonsShow:"","label-position":"top",layout:[2,1],comps:n.value},null,8,["form","comps"])]),_:1},8,["modelValue"])],64)}}}),b="com.particle",s=(a,e,o)=>{let t={};try{t=JSON.parse(a.global)}catch{}t[e]=o,a.global=JSON.stringify(t,(l,n)=>n,"  ")},T=(a,e)=>{e.outputFileParentAbsoluteDir=a.outputFileParentAbsoluteDir,e.ext=a.extJson;let o=JSON.parse(a.globalJson);e.packageModule&&(o.packageModule=e.packageModule),e.global=JSON.stringify(o,null,"  "),o=JSON.parse(a.globalJson);for(let l in o)D(e,l)&&(e[l]=o[l]);let t=e.javaPackageKeys||[];a.javaPackageKeys&&a.javaPackageKeys.split(",").forEach(l=>{t.some(n=>n==l)||t.push(l)}),e.javaPackageKeys=t},A=[{field:{name:"javaPackageKeys"},element:{comp:"el-input",formItemProps:{label:"java包键名",tips:"仅支持 global和ext键表转换，用于将形如：com.particle的包名转换为路径 com/particle,多个以逗号分隔"},compProps:{clearable:!0}}},{field:{name:"outputFileParentAbsoluteDir"},element:{comp:"el-input",formItemProps:{label:"输出文件的父目录绝对路径",tips:"一般为组件的上一级目录，如：/user/yw/test 或 C:\\yw\\test。引用的模板有输出文件或目录时需要填写"},compProps:{clearable:!0}}},{field:{name:"global",value:JSON.stringify({parentPackage:b})},element:{comp:"PtAceEditor",formItemProps:{label:"全局渲染数据"},compProps:{clearable:!0,mode:"ace/mode/json",class:"pt-width-100-pc"}}},{field:{name:"ext",value:"{}"},element:{comp:"PtAceEditor",formItemProps:{label:"扩展渲染数据"},compProps:{clearable:!0,mode:"ace/mode/json",class:"pt-width-100-pc"}}}],E=({props:a})=>[{field:{name:"moduleName",valueChange:({form:e,formData:o,newValue:t})=>{if(s(e,"moduleName",t),t){let l=R(t.toLowerCase(),["-"]);e.moduleNamePackage=l.toLowerCase(),e.moduleNameEntity=G(l)}else e.moduleNamePackage="",e.moduleNameEntity=""}},element:{comp:"el-input",formItemProps:{label:"模块名称",tips:"如：user 或 particle-demo，请不要使用大写",labelTips:"该值会自动放到全局变量中",required:!0},compProps:({form:e})=>({clearable:!0,slots:{append:{is:"PtButton",attrs:{icon:"Search",beforeMethod:()=>a.refrenceSegmentGenId>0||a.isGenerated?!0:"未引用生成数据或尚未生成，请先引用生成数据或生成",method:()=>(console.log(a.isGenerated),J({id:a.isGenerated?a.lowcodeSegmentGenId:a.refrenceSegmentGenId}).then(o=>{let t=o.data.data;return T(t,e),Promise.resolve(o)})),title:"加载引用生成数据,如果已经生成则加载上次生成的填写数据"}}}})}},{field:{name:"author",valueChange:({form:e,formData:o,newValue:t})=>{s(e,"author",t)}},element:{comp:"el-input",formItemProps:{label:"作者",tips:"如：yw",labelTips:"该值会自动放到全局变量中",required:!0},compProps:{clearable:!0}}},{field:{name:"moduleNamePackage",valueChange:({form:e,formData:o,newValue:t})=>{s(e,"moduleNamePackage",t)}},element:{comp:"el-input",formItemProps:{label:"模块名称对应的包名",tips:"如：user 或 particledemo，请不要使用大写",labelTips:"该值会自动放到全局变量中",required:!0},compProps:{clearable:!0}}},{field:{name:"parentPackage",value:b,valueChange:({form:e,formData:o,newValue:t})=>{s(e,"parentPackage",t)}},element:{comp:"el-input",formItemProps:{label:"父包",tips:"如：com.particle，请不要使用大写",labelTips:"该值会自动放到全局变量中",required:!0},compProps:{clearable:!0}}},{field:{name:"moduleNameEntity",valueChange:({form:e,formData:o,newValue:t})=>{s(e,"moduleNameEntity",t)}},element:{comp:"el-input",formItemProps:{label:"模块名称实体化",tips:"保证首字母大写且符合java文件命名",labelTips:"该值会自动放到全局变量中",required:!0},compProps:{clearable:!0}}},{field:{name:"emptyPtDivider"},element:{comp:"PtDivider",formItemProps:{label:""},compProps:{content:"以上为辅助输入，最终以下面json为提交数据",class:"pt-width-100-pc"}}},...A],K=({props:a})=>[{field:{name:"packageModule",valueChange:({form:e,formData:o,newValue:t})=>{s(e,"packageModule",t)}},element:{comp:"el-input",formItemProps:{label:"子包名称",tips:"如：user ，请全部使用小写不要使用分隔符，符合java 包命令规则",labelTips:"该值会自动放到全局变量中"},compProps:{clearable:!0}}},...E({props:a})];export{x as _,K as a,A as g,E as u};
