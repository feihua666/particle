import{d as f,a as q,r as m,b as x,o as w,c as R,e as i,f as F,F as y,a4 as M,R as V,_ as N}from"./index.b53d3025.js";import{b as U}from"./toolsFrontApi.62443b8a.js";const L=f({name:"BatchReplateSqlInsertIdsPage"}),T=f({...L,setup(W){const{proxy:d}=V(),e=q({form:{},resultForm:{result:""},formData:{}}),B=m([{field:{name:"insertSql"},element:{comp:"el-input",formItemProps:{label:"sql\u63D2\u5165\u8BED\u53E5",required:!0},compProps:{clearable:!0,type:"textarea",rows:10}}},{field:{name:"idExtractPattern",value:"VALUES \\(([^,]+),"},element:{comp:"el-input",formItemProps:{label:"id\u63D0\u53D6\u6B63\u5219\u8868\u8FBE\u5F0F",required:!0,tips:"\u7ECF\u6D4B\u8BD5\uFF0C\u9ED8\u8BA4\u7684\u6B63\u5219\u8868\u8FBE\u5F0F\u652F\u6301datagrip\u548Cnavicat\u590D\u5236\u7684sql\u63D2\u5165\u8BED\u53E5"},compProps:{clearable:!0}}},{field:{name:"valueSeparator",value:"="},element:{comp:"el-input",formItemProps:{label:"\u503C\u5206\u9694\u7B26",tips:"\u5982\u679C\u88AB\u66FF\u6362\u7684\u6587\u672C\u5305\u62EC\u5206\u9694\u7B26\u65F6\uFF0C\u8BF7\u586B\u5199\u5176\u5B83\u5206\u9694\u7B26",required:!0},compProps:{clearable:!0}}},{field:{name:"groupSeparator",value:";"},element:{comp:"el-input",formItemProps:{label:"\u7EC4\u5206\u9694\u7B26",tips:"\u5982\u679C\u88AB\u66FF\u6362\u7684\u6587\u672C\u5305\u62EC\u5206\u9694\u7B26\u65F6\uFF0C\u8BF7\u586B\u5199\u5176\u5B83\u5206\u9694\u7B26",required:!0},compProps:{clearable:!0}}},{field:{name:"replaceText",value:"VALUES (=;,="},element:{comp:"el-input",formItemProps:{label:"\u63D0\u53D6\u5B8C\u6210\u540E\u66FF\u6362",tips:"\u652F\u6301\u591A\u7EC4\u66FF\u6362\u5982\uFF1Aa=b,c=d\u5C06\u4F1A\u628Aa\u66FF\u6362\u6210b\uFF0Cc\u66FF\u6362\u6210d"},compProps:{clearable:!0}}}]),h=m([{field:{name:"result"},element:{comp:"el-input",formItemProps:{label:"\u66FF\u6362\u7ED3\u679C"},compProps:{clearable:!0,type:"textarea",rows:25}}}]),b=m({buttonText:"\u786E\u8BA4\u66FF\u6362"}),C=()=>{n.value=[],c.value=0,e.resultForm.result="",E()},I=(t,u)=>{U({num:t}).then(r=>{for(let l=0;l<r.data.data.length;l++)n.value.push(r.data.data[l]);u()})},E=()=>{let t=e.form.insertSql.split(`
`),u=100,r=Math.ceil(t.length/u)+1;const l=s=>{s.forEach(o=>{if(!o||!o.trim())return;let p=M(e.form.idExtractPattern,o);if(p.length===0){P("\u6CA1\u6709\u5339\u914D\u5230\u5185\u5BB9");return}let g=v(p[0]),S=D();A(g,S)})},a=(s,o)=>{I(u,()=>{s-=1,s>0?a(s,o):o()})};a(r,()=>{l(t)})},n=m([]),c=m(0),D=()=>n.value[c.value++],v=t=>{let u="",r=e.form.replaceText;return r&&r.split(e.form.groupSeparator).forEach(l=>{let a=l.split(e.form.valueSeparator);u?u=u.replaceAll(a[0],a[1]):u=t.replaceAll(a[0],a[1])}),u},A=(t,u)=>{e.resultForm.result?e.resultForm.result=e.resultForm.result.replaceAll(t,u):e.resultForm.result=e.form.insertSql.replaceAll(t,u)},P=t=>{d.$message({showClose:!0,message:t,type:"error",showIcon:!0,grouping:!0})},_=()=>"\u66FF\u6362\u6210\u529F";return(t,u)=>{const r=x("PtForm");return w(),R(y,null,[i(" \u6DFB\u52A0\u8868\u5355 "),F(r,{form:e.form,formData:e.formData,labelWidth:"80",method:C,methodSuccess:_,defaultButtonsShow:"submit,reset",submitAttrs:b.value,layout:[1,3,1],comps:B.value},null,8,["form","formData","submitAttrs","comps"]),i(" \u7ED3\u679C\u8868\u5355 "),F(r,{form:e.resultForm,labelWidth:"80",defaultButtonsShow:"",layout:1,comps:h.value},null,8,["form","comps"])],64)}}}),$=N(T,[["__file","/Users/yw/fh/git-source/particle/web/component/pc/tools/views/front/BatchReplateSqlInsertIdsPage.vue"]]);export{$ as default};
