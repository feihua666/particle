import{p as R,t as v,a as y,r as w}from"./openplatformOpenapiBatchQueryRecordAdminApi-CAu001sT.js";import{d as D,r as h,a as O,b as a,o as C,c as F,e as n,w as _,F as Q,ar as T,as as A}from"./index-_8rL1G8m.js";import{e as I,d as V}from"./FileTools-Cx4MUywI.js";import"./openplatformAppCompItem-DhvLbyKP.js";import"./openplatformAppAdminApi-BfcI6YuV.js";import"./openplatformOpenapiCompItem-C_C29-BD.js";import"./crmCompItem-BmbgZ0A6.js";import"./crmCustomerTagAdminApi-CEtzmh3W.js";const W=D({__name:"OpenplatformOpenapiBatchQueryRecordManagePage",setup(M){const c=h(null),r=O({form:{},formComps:R,tableColumns:v}),l=h({buttonText:"查询",loading:!1,permission:"admin:web:openplatformOpenapiBatchQueryRecord:pageQuery"}),f=()=>{c.value.refreshData()},x=({pageQuery:e})=>y({...r.form,...e}),g={permission:l.value.permission},B=({row:e,column:s,$index:i})=>{if(i<0)return[];e.id;let p={openplatformOpenapiBatchQueryRecordId:e.id};return[{txt:"下载",text:!0,disabled:e.executeStatusDictValue!="finished",disabledReason:e.executeStatusDictValue!="finished"?"执行完成后才可能下载":void 0,method(){let t=T(e.exportFileUrl),m=t.substring(t.lastIndexOf("/")+1);return A(t).then(o=>{let u=o.data,d=I(o),P=decodeURIComponent(m);return V(u,d,P),Promise.resolve(o)})}},{txt:"查看详情",text:!0,position:"more",permission:"admin:web:openplatformOpenapiBatchQueryRecordDetail:pageQuery",route:{path:"/admin/openplatformOpenapiBatchQueryRecordDetail",query:p}},{txt:"删除",text:!0,position:"more",permission:"admin:web:openplatformOpenapiBatchQueryRecord:delete",methodConfirmText:`确定要删除 ${e.name} 吗？`,method(){return w({id:e.id}).then(t=>(f(),Promise.resolve(t)))}}]};return(e,s)=>{const i=a("PtForm"),p=a("PtButtonGroup"),b=a("el-table-column"),t=a("PtTable"),m=a("PtRouteViewPopover");return C(),F(Q,null,[n(i,{form:r.form,method:f,defaultButtonsShow:"submit,reset",submitAttrs:l.value,inline:"",labelWidth:"80",comps:r.formComps},null,8,["form","submitAttrs","comps"]),n(t,{ref_key:"tableRef",ref:c,"default-expand-all":"",dataMethod:x,onDataMethodDataLoading:s[0]||(s[0]=o=>l.value.loading=o),paginationProps:g,columns:r.tableColumns},{defaultAppend:_(()=>[n(b,{label:"操作",width:"180"},{default:_(({row:o,column:u,$index:d})=>[n(p,{options:B({row:o,column:u,$index:d}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),n(m,{level:3})],64)}}});export{W as default};
