import{d as A,r as n,a as h,b as B,a$ as g,o as f,c as y,e as u,f as c,b0 as O,i as P,F as R,aX as F,_ as w}from"./index.3ad8a272.js";import{b as S,s as q}from"./openplatformOpenapiCompItem.7cd29828.js";import{a as I}from"./openplatformAppCompItem.c1ed52b0.js";import{a as k}from"./openplatformDocApiAdminApi.5762ebfa.js";import"./openplatformAppAdminApi.a2f92414.js";const x=A({name:"OpenplatformOpenapiDataQueryPage"}),Q=A({...x,setup(N){const i=n(null),l=n(null),s=n(null),e=h({form:{},formComps:[I({label:"\u5E94\u7528",required:!0,valueChange:({form:a,newValue:o})=>{o||(a.openplatformOpenapiId=null)},tips:" 1. \u8BF7\u5148\u9009\u62E9\u8981\u4F7F\u7528\u7684\u5E94\u7528"}),S({fieldName:"openplatformOpenapiId",label:"\u5F00\u653E\u63A5\u53E3",required:!0,disableGroup:!0,valueChange:({form:a,newValue:o})=>{b(o)},tips:" 2. \u8BF7\u9009\u62E9\u8981\u67E5\u8BE2\u7684\u63A5\u53E3"})],dynamicform:{},dynamicformComps:[],dynamicformCompsReady:!1,dynamicformLoading:!1,resultForm:{result:""},resultFormComps:[{field:{name:"result"},element:{comp:"el-input",formItemProps:{label:"\u8C03\u7528\u7ED3\u679C"},compProps:{clearable:!0,type:"textarea",rows:25,readonly:!0,placeholder:"\u8BE5\u533A\u57DF\u663E\u793A\u67E5\u8BE2\u7ED3\u679C\uFF0C\u4E3A\u53EA\u8BFB\u72B6\u6001\uFF0C\u70B9\u51FB\u91CD\u7F6E\u4F1A\u6E05\u7A7A\u8BE5\u533A\u57DF\u6570\u636E"}}}],openplatformDocApiAllDetail:null}),p=n({buttonText:"\u67E5\u8BE2",loading:!1,permission:"admin:web:openplatformOpenapi:singleQuery"}),E=()=>{D(()=>{v(()=>{p.value.loading=!0,C().then(a=>{let o=a.data.data;try{let r=JSON.parse(o),t=JSON.stringify(r,null,"   ");e.resultForm.result=t}catch{e.resultForm.result=o}}).finally(()=>{p.value.loading=!1})})})},D=a=>{i.value&&i.value.formRef.validate((o,r)=>{o&&a()})},v=a=>{l.value&&l.value.formRef.validate((o,r)=>{o&&a()})},C=()=>{let a={bodyParam:null,queryStringParam:null};for(let r in e.form)a[r]=e.form[r];let o={};for(let r in e.dynamicform)o[r]=e.dynamicform[r];return F(o)||(a.bodyParam=o),q(a)},b=a=>{e.dynamicformCompsReady=!1,a&&(e.dynamicformLoading=!0,k({openplatformOpenapiId:a}).then(o=>{e.openplatformDocApiAllDetail=o.data,d()}).catch(o=>{e.openplatformDocApiAllDetail=null,d()}).finally(()=>{e.dynamicformLoading=!1,e.dynamicformCompsReady=!0}))},d=()=>{if(e.dynamicform={},e.dynamicformComps=[],!e.openplatformDocApiAllDetail)return;let a=e.openplatformDocApiAllDetail.data;if(F(a))return;let r=a.docApiDocParamFieldVOsMap.request_param;for(let t=0;t<r.length;t++){let m=r[t];m.parentId||e.dynamicformComps.push({field:{name:m.name},element:{comp:"el-input",formItemProps:{label:m.explanation,required:m.isRequired},compProps:{clearable:!0}}})}},_=()=>{l.value&&l.value.resetForm(),s.value&&s.value.resetForm()};return(a,o)=>{const r=B("PtForm"),t=g("loading");return f(),y(R,null,[u(" \u67E5\u8BE2\u8868\u5355 "),c(r,{ref_key:"formRef",ref:i,form:e.form,labelWidth:"120",defaultButtonsShow:"",inline:"",layout:2,comps:e.formComps},null,8,["form","comps"]),O((f(),y("div",null,[u(" \u52A8\u6001\u67E5\u8BE2\u8868\u5355 "),e.dynamicformCompsReady?(f(),P(r,{key:0,ref_key:"dynamicFormRef",ref:l,form:e.dynamicform,labelWidth:"120",defaultButtonsShow:"",inline:"",comps:e.dynamicformComps},null,8,["form","comps"])):u("v-if",!0)])),[[t,e.dynamicformLoading]]),u(" \u6309\u94AE\u8868\u5355 "),c(r,{form:[],labelWidth:"120",method:E,defaultButtonsShow:"submit,reset",submitAttrs:p.value,inline:"",showButtonItem:!0,onResetForm:_,comps:[]},null,8,["submitAttrs"]),u(" \u7ED3\u679C\u8868\u5355 "),c(r,{ref_key:"resultFormRef",ref:s,form:e.resultForm,labelWidth:"80",defaultButtonsShow:"",layout:1,comps:e.resultFormComps},null,8,["form","comps"])],64)}}}),K=w(Q,[["__file","/Users/yw/fh/git-source/particle/web/component/pc/openplatform/views/openapi/admin/OpenplatformOpenapiDataQueryPage.vue"]]);export{K as default};
