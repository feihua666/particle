import{i as _,d as D,r as g,a as L,b as m,o as y,c as A,e as s,w as h,F as C}from"./index-_8rL1G8m.js";import{p as x}from"./opLogAdminApi-BJtQYGiV.js";let w="/admin/web/op_log_audit_data";const O=e=>_.delete(w+"/delete",{data:e}),B=e=>_.get(w+"/page",{params:e}),R={opLogId:{type:String},opLogName:String},S=({props:e,required:r=!1,fieldName:p="opLogId",propOpLogIdFieldName:o="opLogId",propOpLogNicknameFieldName:a="opLogName",label:n="操作日志",valueChange:i=()=>{}})=>({field:{name:p,value:e[o],valueChange:i},element:{comp:"PtSelect",formItemProps:{label:n,required:r},compProps:()=>{let l=!!(e[o]&&e[a]);return{placeholder:"输入操作名称",disabled:l,dataMethod:()=>l?{data:[{id:e[o],name:e[a]}]}:{data:[]},remote:!l,remoteMethod:t=>t?x({name:t}):{data:[]},props:{label:"name"}}}}}),E=({props:e})=>[{field:{name:"name"},element:{comp:"el-input",formItemProps:{label:"字段名称"},compProps:{clearable:!0,placeholder:"左前缀匹配，如：昵称"}}},{field:{name:"propertyName"},element:{comp:"el-input",formItemProps:{label:"数据字段"},compProps:{clearable:!0,placeholder:"左前缀匹配，如：nickname"}}},{field:{name:"oldValue"},element:{comp:"el-input",formItemProps:{label:"旧值"},compProps:{clearable:!0}}},{field:{name:"newValue"},element:{comp:"el-input",formItemProps:{label:"新值"},compProps:{clearable:!0}}},{field:{name:"changeTypeDictId"},element:{comp:"PtDictFrontSelect",formItemProps:{label:"值改变类型字典"},compProps:{dictParam:{groupCode:"op_log_audit_data_change_type"}}}},{field:{name:"changeType"},element:{comp:"el-input",formItemProps:{label:"值改变类型"},compProps:{clearable:!0,placeholder:"如：PROPERTY_VALUE_CHANGED"}}},{field:{name:"typeDictId"},element:{comp:"PtDictFrontSelect",formItemProps:{label:"类型对应的字典"},compProps:{dictParam:{groupCode:"op_log_type"}}}},{field:{name:"type"},element:{comp:"el-input",formItemProps:{label:"类型"},compProps:{clearable:!0,placeholder:"如：create"}}},{field:{name:"dataId"},element:{comp:"el-input",formItemProps:{label:"数据id"},compProps:{}}},{field:{name:"dataTable"},element:{comp:"el-input",formItemProps:{label:"数据表名"},compProps:{clearable:!0}}},{field:{name:"dataEntity"},element:{comp:"el-input",formItemProps:{label:"数据载体"},compProps:{clearable:!0}}},S({props:e})],F=D({__name:"OpLogAuditDataManagePage",props:{...R},setup(e){const r=g(null),p=e,o=L({form:{opLogId:p.opLogId},formComps:E({props:p}),tableColumns:[{prop:"name",label:"字段名称",showOverflowTooltip:!0},{prop:"propertyName",label:"数据字段",showOverflowTooltip:!0},{prop:"oldValue",label:"旧值",showOverflowTooltip:!0},{prop:"newValue",label:"新值",showOverflowTooltip:!0},{prop:"changeTypeDictName",label:"值改变类型字典"},{prop:"dataId",label:"数据id",showOverflowTooltip:!0},{prop:"dataTable",label:"数据表名",showOverflowTooltip:!0},{prop:"dataEntity",label:"数据载体",showOverflowTooltip:!0},{prop:"opLogName",label:"操作日志",showOverflowTooltip:!0}]}),a=g({buttonText:"查询",loading:!1,permission:"admin:web:opLogAuditData:pageQuery"}),n=()=>{r.value.refreshData()},i=({pageQuery:t})=>B({...o.form,...t}),l={permission:a.value.permission},b=({row:t,column:u,$index:c})=>c<0?[]:(t.id,[{txt:"删除",text:!0,permission:"admin:web:opLogAuditData:delete",methodConfirmText:`确定要删除 ${t.name} 吗？`,method(){return O({id:t.id}).then(d=>(n(),Promise.resolve(d)))}}]);return(t,u)=>{const c=m("PtForm"),P=m("PtButtonGroup"),d=m("el-table-column"),I=m("PtTable");return y(),A(C,null,[s(c,{form:o.form,method:n,defaultButtonsShow:"submit,reset",submitAttrs:a.value,inline:"","label-width":"120",comps:o.formComps},null,8,["form","submitAttrs","comps"]),s(I,{ref_key:"tableRef",ref:r,"default-expand-all":"",dataMethod:i,onDataMethodDataLoading:u[0]||(u[0]=f=>a.value.loading=f),paginationProps:l,columns:o.tableColumns},{defaultAppend:h(()=>[s(d,{label:"操作",width:"100"},{default:h(({row:f,column:T,$index:v})=>[s(P,{options:b({row:f,column:T,$index:v})},null,8,["options"])]),_:1})]),_:1},8,["columns"])],64)}}});export{F as default};
