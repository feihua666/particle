import{p as w,r as v}from"./openplatformOpenapiCompItem-Ca8vJa8p.js";import{p as T}from"./openplatformOpenapiManage-B3hStA_V.js";import{d as B,r as c,a as D,b as n,o as C,c as R,e as r,w as m,f as A,F as M}from"./index-B_FSv1tI.js";import"./openplatformOpenapiFeeCompItem-QDS4pj3x.js";import"./openplatformOpenapiFeeAdminApi-L1sOooKm.js";import"./treeQueryComps-CWIG2rsy.js";import"./openplatformProviderCompItem-B6GnMjUI.js";import"./openplatformProviderAdminApi-B07nyAAe.js";const $=B({__name:"OpenplatformOpenapiManagePage",setup(y){const f=c(null),l=D({form:{},formComps:T,tableColumns:[{prop:"name",label:"名称",width:"250",showOverflowTooltip:!0},{prop:"code",label:"编码"},{prop:"isGroup",label:"是否为组",formatter:(e,a,t,i)=>t?"分组":"接口"},{prop:"permissions",label:"接口权限码",showOverflowTooltip:!0},{prop:"url",label:"接口地址",showOverflowTooltip:!0},{prop:"isDisabled",label:"是否禁用",formatter:(e,a,t,i)=>{let o=t?"禁用":"启用";return t&&e.disabledReason&&(o=o+`(${e.disabledReason})`),o}},{prop:"defaultOpenplatformOpenapiFeeName",label:"默认计费规则"},{prop:"parentName",label:"父级"},{prop:"remark",label:"描述",showOverflowTooltip:!0}]}),u=c({buttonText:"查询",loading:!1,permission:"admin:web:openplatformOpenapi:pageQuery"}),b=()=>{f.value.refreshData()},_=({pageQuery:e})=>w({...l.form,...e}),g={permission:u.value.permission},O=({row:e,column:a,$index:t})=>{if(t<0)return[];let o=[{txt:"编辑",text:!0,permission:"admin:web:openplatformOpenapi:update",route:{path:"/admin/OpenplatformOpenapiManageUpdate",query:{id:e.id}}},{txt:"删除",text:!0,position:"more",permission:"admin:web:openplatformOpenapi:delete",methodConfirmText:`确定要删除 ${e.name} 吗？`,method(){return v({id:e.id}).then(p=>(b(),Promise.resolve(p)))}}],s="/openapi/dq";if(e.url&&e.url.indexOf(s)==0){let p={dqUrl:e.url.replace(s,"")};o.push({txt:"查看查询接口",text:!0,position:"more",permission:"admin:web:dataQueryDataApi:pageQuery",route:{path:"/admin/dataQueryDataApiManagePage",query:p}})}return o};return(e,a)=>{const t=n("PtButton"),i=n("PtForm"),o=n("PtButtonGroup"),s=n("el-table-column"),p=n("PtTable"),x=n("PtRouteViewPopover");return C(),R(M,null,[r(i,{form:l.form,labelWidth:"120",method:b,defaultButtonsShow:"submit,reset",submitAttrs:u.value,inline:"",comps:l.formComps},{buttons:m(()=>[r(t,{permission:"admin:web:openplatformOpenapi:create",route:"/admin/OpenplatformOpenapiManageAdd"},{default:m(()=>a[1]||(a[1]=[A("添加")])),_:1})]),_:1},8,["form","submitAttrs","comps"]),r(p,{ref_key:"tableRef",ref:f,"default-expand-all":"",dataMethod:_,onDataMethodDataLoading:a[0]||(a[0]=d=>u.value.loading=d),dataMethodResultHandleConvertToTree:!0,paginationProps:g,columns:l.tableColumns},{defaultAppend:m(()=>[r(s,{label:"操作",width:"180"},{default:m(({row:d,column:P,$index:h})=>[r(o,{options:O({row:d,column:P,$index:h}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),r(x,{level:3})],64)}}});export{$ as default};
