import{d as C,r as g,a as S,a8 as v,af as P,b as c,o as _,c as D,e as E,f as r,w as m,F as B,_ as J,j as h,g as I,i as V}from"./index.3ad8a272.js";import{o as M}from"./dataQueryDatasourceApiManage.8dda0fa4.js";const x=C({name:"AdaptMultipleAggregationConfig"}),q=C({...x,props:{initJsonStr:{type:String}},setup(p,{expose:A}){const u=p,n=g(null),t=S({initJson:{aggregationItems:[]},form:{datasourceApiName:""},formComps:[{field:{name:"outputKey"},element:{comp:"el-input",formItemProps:{label:"\u805A\u5408\u53D8\u91CF",required:!0,tips:"\u5C06\u4EE5\u8BE5\u53D8\u91CF\u505A\u4E3A\u8F93\u51FA\u5BF9\u8C61\u7684key"},compProps:{clearable:!0}}},{field:{name:"dataQueryDatasourceApiId",valueChange({form:e,formData:a}){v(()=>{var i;a.dataQueryDatasourceApiId&&(e.datasourceApiName=(i=a.dataQueryDatasourceApiId)==null?void 0:i.name)})}},element:{comp:"PtSelect",formItemProps:{label:"\u6570\u636E\u67E5\u8BE2\u6570\u636E\u6E90\u63A5\u53E3",required:!0},compProps:{dataMethod:M}}}],tableColumns:[{prop:"outputKey",label:"\u805A\u5408\u53D8\u91CF"},{prop:"datasourceApiName",label:"\u6570\u636E\u67E5\u8BE2\u6570\u636E\u6E90\u63A5\u53E3"}]});P(()=>{u.initJsonStr&&(t.initJson=JSON.parse(u.initJsonStr))});const o=g({buttonText:"\u6DFB\u52A0\u793A\u4F8B"}),d=()=>{let e={outputKey:t.form.outputKey,dataQueryDatasourceApiId:t.form.dataQueryDatasourceApiId,datasourceApiName:t.form.datasourceApiName};t.initJson.aggregationItems.push(e)},l=({row:e,column:a,$index:i})=>i<0?[]:[{txt:"\u5220\u9664",text:!0,methodConfirmText:`\u786E\u5B9A\u8981\u5220\u9664 ${e.name} \u5417\uFF1F`,method(){t.initJson.aggregationItems.splice(i,1)}}];return A({getInitJson:()=>t.initJson}),(e,a)=>{const i=c("PtForm"),b=c("PtButtonGroup"),s=c("el-table-column"),y=c("PtTable");return _(),D(B,null,[E(" \u6DFB\u52A0\u8868\u5355 "),r(i,{form:t.form,formData:t.formData,class:"pt-wdith-100-pc",method:d,defaultButtonsShow:"submit,reset",submitAttrs:o.value,layout:1,comps:t.formComps},null,8,["form","formData","submitAttrs","comps"]),r(y,{ref_key:"tableRef",ref:n,options:t.initJson.aggregationItems,columns:t.tableColumns},{defaultAppend:m(()=>[r(s,{label:"\u64CD\u4F5C",width:"180"},{default:m(({row:F,column:f,$index:w})=>[r(b,{options:l({row:F,column:f,$index:w})},null,8,["options"])]),_:1})]),_:1},8,["options","columns"])],64)}}}),N=J(q,[["__file","/Users/yw/fh/git-source/particle/web/component/pc/dataquery/components/dataapi/admin/apiconfigs/AdaptMultipleAggregationConfig.vue"]]),k=C({name:"AdaptCustomScriptConfig"}),R=C({...k,props:{initJsonStr:{type:String},onSubmit:{type:Function,default:()=>({})}},setup(p,{expose:A}){const u=p,n=S({form:{}}),t=[{field:{name:"customScriptType"},element:{comp:"PtDictFrontSelect",formItemProps:{label:"\u811A\u672C\u7C7B\u578B",required:!0},compProps:{dictParam:{groupCode:"dataquery_data_api_custom_script_type"},props:{value:"value"}}}},{field:{name:"scriptTemplate"},element:{comp:"el-input",formItemProps:{label:"\u811A\u672C\u5185\u5BB9",required:!0,tips:'groovy\u793A\u4F8B\uFF1Adef map = new HashMap();map.put("result1",datasourceApi.invoke("datasourceApiCode",data,queryStr));map; \u4EE5\u4E0A\u4E3A\u63A5\u53E3\u805A\u5408\u793A\u4F8B\uFF0C\u5176\u4E2D datasourceApi \u5305\u62EC\u4E09\u4E2A\u53C2\u6570 \u53C2\u65701=\u6570\u636E\u67E5\u8BE2\u6570\u636E\u6E90\u63A5\u53E3\u7F16\u7801\uFF0C2=\u8BF7\u6C42\u53C2\u6570\uFF0Cdata\u53D8\u91CF\u4E3A\u8BF7\u6C42\u53C2\u6570\u53E5\u67C4,3=\u67E5\u8BE2\u5B57\u7B26\u4E32\u53C2\u6570\uFF0C\u6700\u540E map \u9700\u8981\u8FD4\u56DE\u5904\u7406\u7ED3\u679C,\u652F\u6301\u4F7F\u7528dataQueryDataApiExecutor\u53E5\u67C4\u5F15\u7528\u7EBF\u7A0B\u6C60\u52A0\u901F\u5904\u7406'},compProps:{type:"textarea",rows:15,clearable:!0}}}];P(()=>{if(u.initJsonStr){let l=JSON.parse(u.initJsonStr);for(let e in l)n.form[e]=l[e]}});const o=g({buttonText:"\u786E\u8BA4"}),d=()=>{u.onSubmit()};return A({form:n.form}),(l,e)=>{const a=c("PtForm");return _(),D(B,null,[E(" \u6DFB\u52A0\u8868\u5355 "),r(a,{ref:"selfFormRef",form:n.form,class:"pt-wdith-100-pc",method:d,defaultButtonsShow:"submit,reset",submitAttrs:o.value,layout:1,comps:t},null,8,["form","submitAttrs"])],2112)}}}),T=J(R,[["__file","/Users/yw/fh/git-source/particle/web/component/pc/dataquery/components/dataapi/admin/apiconfigs/AdaptCustomScriptConfig.vue"]]),Q=h("div",{id:"dataqueryDatasourceApiAdaptCustomScriptConfigDialogFooter"},null,-1),O=C({name:"DataQueryDatasApiFormItemConfigs"}),K=C({...O,props:{form:{type:Object,required:!0},formData:{type:Object,required:!0}},setup(p,{expose:A}){const u=p,n=g(null),t=g(null),o=S({adaptMultipleAggregationConfigJson:{dialogVisible:!1},adaptCustomScriptConfig:{dialogVisible:!1}}),d=b=>JSON.stringify(b),l=()=>{n.value.getInitJson().aggregationItems.length>0?u.form.adaptConfigJson=d(n.value.getInitJson()):u.form.adaptConfigJson="",o.adaptMultipleAggregationConfigJson.dialogVisible=!1},e=()=>{u.form.adaptConfigJson=d(t.value.form),o.adaptCustomScriptConfig.dialogVisible=!1},a=g(!1),i=()=>{v(()=>{a.value=!0})};return A({reactiveData:o}),(b,s)=>{const y=c("PtButton"),F=c("el-dialog");return _(),D(B,null,[r(F,{modelValue:o.adaptMultipleAggregationConfigJson.dialogVisible,"onUpdate:modelValue":s[0]||(s[0]=f=>o.adaptMultipleAggregationConfigJson.dialogVisible=f),width:"70%",title:"\u591A\u63A5\u53E3\u805A\u5408\u914D\u7F6EJson","append-to-body":"","destroy-on-close":""},{footer:m(()=>[h("span",null,[r(y,{type:"primary",onClick:l},{default:m(()=>[I("\u786E\u8BA4")]),_:1})])]),default:m(()=>[r(N,{ref_key:"adaptMultipleAggregationConfigRef",ref:n,initJsonStr:p.form.adaptConfigJson},null,8,["initJsonStr"])]),_:1},8,["modelValue"]),r(F,{modelValue:o.adaptCustomScriptConfig.dialogVisible,"onUpdate:modelValue":s[1]||(s[1]=f=>o.adaptCustomScriptConfig.dialogVisible=f),width:"70%",title:"\u81EA\u5B9A\u4E49\u811A\u672C\u914D\u7F6EJson",onOpen:i,onClosed:s[2]||(s[2]=f=>a.value=!1),"append-to-body":"","destroy-on-close":""},{footer:m(()=>[E("   \u5C06\u8868\u5355\u6309\u94AE\u4F20\u9001\u5230\u8FD9\u91CC   "),Q]),default:m(()=>[a.value?(_(),V(T,{key:0,ref_key:"adaptCustomScriptConfigConfigRef",ref:t,initJsonStr:p.form.adaptConfigJson,onSubmit:e,buttonsTeleportProps:{disabled:!1,to:"#dataqueryDatasourceApiAdaptCustomScriptConfigDialogFooter"}},null,8,["initJsonStr"])):E("v-if",!0)]),_:1},8,["modelValue"])],64)}}}),j=J(K,[["__file","/Users/yw/fh/git-source/particle/web/component/pc/dataquery/components/dataapi/admin/DataQueryDatasApiFormItemConfigs.vue"]]);export{j as D};
