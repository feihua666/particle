import{p as N,g as T,d as J,c as B,a as R,r as y,e as D}from"./scheduleJobAdminApi-BIAYvFId.js";import{d as j,r as b,a as E,b as n,o as A,c as M,e as a,w as u,f as F,F as S}from"./index-DoSQKVHz.js";const V=j({__name:"ScheduleJobManagePage",props:{schedulerName:{type:String},schedulerInstanceId:{type:String}},setup(x){const i=b(null),p=x,s=E({form:{schedulerName:p.schedulerName,schedulerInstanceId:p.schedulerInstanceId},formComps:N,tableColumns:[{prop:"schedulerName",label:"任务计划名称"},{prop:"schedulerInstanceId",label:"任务计划实例id"},{prop:"name",label:"任务名称"},{prop:"group",label:"任务组"},{prop:"cronExpression",label:"cronExpression"},{prop:"isDurable",label:"如果没有关联触发器是否持久化"},{prop:"isPersistJobDataAfterExecution",label:"执行完成是否持久化"},{prop:"isConcurrentExectionDisallowed",label:"是否不允许并行"},{prop:"isRecovery",label:"是否可恢复"},{prop:"jobClassName",label:"类名称",showOverflowTooltip:!0},{prop:"description",label:"描述"}]}),m=b({buttonText:"查询",loading:!1,permission:"schedule:getJobDetailList"}),r=()=>{i.value.refreshData()},f=({pageQuery:e})=>T({...s.form,...e}),g={permission:m.value.permission},P=({row:e,column:l,$index:d})=>{if(d<0)return[];e.schedulerName,e.schedulerInstanceId;let o={schedulerName:e.schedulerName,schedulerInstanceId:e.schedulerInstanceId,name:e.name,group:e.group};return e.schedulerName,e.schedulerInstanceId,[{txt:"编辑",text:!0,permission:"schedule:job:update",route:{path:"/admin/scheduleJobManageUpdatePage",query:o}},{txt:"删除",text:!0,position:"more",permission:"schedule:job:delete",methodConfirmText:`确定要删除 ${e.name} 吗？`,method(){return J(o).then(t=>(r(),Promise.resolve(t)))}},{txt:"查看执行记录",text:!0,position:"more",permission:"admin:web:schedulerExecuteRecord:pageQuery",route:{path:"/admin/schedulerExecuteRecordManagePage",query:o}},{txt:"复制",text:!0,position:"more",permission:"schedule:job:copy",methodConfirmText:`确定要复制 ${e.name} 吗？`,method(){return B(o).then(t=>(r(),Promise.resolve(t)))}},{txt:"暂停",text:!0,position:"more",permission:"schedule:job:pause",methodConfirmText:`确定要暂停 ${e.name} 吗？任务关联的所有的触发器都会被暂停`,method(){return R(o).then(t=>(r(),Promise.resolve(t)))}},{txt:"恢复",text:!0,position:"more",permission:"schedule:job:resume",methodConfirmText:`确定要恢复 ${e.name} 吗？任务关联的所有的触发器都会被恢复`,method(){return y(o).then(t=>(r(),Promise.resolve(t)))}},{txt:"手动执行一次",text:!0,position:"more",permission:"schedule:job:executeOnce",methodConfirmText:`确定要手动执行一次 ${e.name} 吗？`,method(){return D(o).then(t=>(r(),Promise.resolve(t)))}}]};return(e,l)=>{const d=n("PtButton"),o=n("PtForm"),h=n("PtButtonGroup"),t=n("el-table-column"),I=n("PtTable"),_=n("PtRouteViewPopover");return A(),M(S,null,[a(o,{form:s.form,method:r,defaultButtonsShow:"submit,reset",submitAttrs:m.value,inline:"",labelWidth:"110",comps:s.formComps},{buttons:u(()=>[a(d,{permission:"schedule:job:add",route:{path:"/admin/scheduleJobManageAddPage",query:{schedulerName:s.form.schedulerName,schedulerInstanceId:s.form.schedulerInstanceId}}},{default:u(()=>l[1]||(l[1]=[F("添加任务")])),_:1},8,["route"])]),_:1},8,["form","submitAttrs","comps"]),a(I,{ref_key:"tableRef",ref:i,"default-expand-all":"",dataMethod:f,onDataMethodDataLoading:l[0]||(l[0]=c=>m.value.loading=c),paginationProps:g,columns:s.tableColumns},{defaultAppend:u(()=>[a(t,{label:"操作",width:"180"},{default:u(({row:c,column:v,$index:C})=>[a(h,{options:P({row:c,column:v,$index:C}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),a(_,{level:3})],64)}}});export{V as default};
