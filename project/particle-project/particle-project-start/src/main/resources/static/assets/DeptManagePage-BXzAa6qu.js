import{p as x,r as T}from"./deptCompItem-Cgt59Y8_.js";import{p as B}from"./deptManage-C-rs4aRe.js";import{d as C,r as c,a as D,b as r,o as N,c as R,e as a,w as m,f as U,F as M}from"./index-DoSQKVHz.js";import"./deptTreeNameAdminApi-B9jKmPVM.js";import"./userCompItem-D0ziwGpi.js";import"./userAdminApi-BrVTPQqU.js";import"./treeQueryComps-CWIG2rsy.js";const q=C({__name:"DeptManagePage",setup(k){const u=c(null),s=D({form:{},formComps:B,tableColumns:[{prop:"name",label:"部门名称",showOverflowTooltip:!0},{prop:"code",label:"部门编码",showOverflowTooltip:!0},{prop:"typeDictName",label:"类型",showOverflowTooltip:!0},{prop:"masterUserName",label:"负责人",formatter:(e,o,t,n)=>t||e.masterUserNickname,showOverflowTooltip:!0},{prop:"isVirtual",label:"是否虚拟",formatter:(e,o,t,n)=>t?"虚拟部门":"实体部门"},{prop:"isComp",label:"是否公司",formatter:(e,o,t,n)=>t?"公司":"部门"},{prop:"parentName",label:"父级",showOverflowTooltip:!0},{prop:"remark",label:"描述",showOverflowTooltip:!0}]}),p=c({buttonText:"查询",loading:!1,permission:"admin:web:dept:pageQuery"}),d=()=>{u.value.refreshData()},f=({pageQuery:e})=>x({...s.form,...e}),b={permission:p.value.permission},_=({row:e,column:o,$index:t})=>t<0?[]:(e.id,[{txt:"编辑",text:!0,permission:"admin:web:dept:update",route:{path:"/admin/DeptManageUpdate",query:{id:e.id,masterUserId:e.masterUserId,masterUserName:e.masterUserName||e.masterUserNickname}}},{txt:"删除",text:!0,permission:"admin:web:dept:delete",methodConfirmText:`确定要删除 ${e.name} 吗？`,method(){return T({id:e.id}).then(l=>(d(),Promise.resolve(l)))}}]);return(e,o)=>{const t=r("PtButton"),n=r("PtForm"),l=r("PtButtonGroup"),w=r("el-table-column"),v=r("PtTable"),P=r("PtRouteViewPopover");return N(),R(M,null,[a(n,{form:s.form,method:d,defaultButtonsShow:"submit,reset",submitAttrs:p.value,inline:"",labelWidth:"120",comps:s.formComps},{buttons:m(()=>[a(t,{permission:"admin:web:dept:create",route:"/admin/DeptManageAdd"},{default:m(()=>o[1]||(o[1]=[U("添加")])),_:1})]),_:1},8,["form","submitAttrs","comps"]),a(v,{ref_key:"tableRef",ref:u,"default-expand-all":"",dataMethod:f,onDataMethodDataLoading:o[0]||(o[0]=i=>p.value.loading=i),dataMethodResultHandleConvertToTree:!0,paginationProps:b,columns:s.tableColumns},{defaultAppend:m(()=>[a(w,{label:"操作",width:"180"},{default:m(({row:i,column:h,$index:g})=>[a(l,{options:_({row:i,column:h,$index:g})},null,8,["options"])]),_:1})]),_:1},8,["columns"]),a(P,{level:3})],64)}}});export{q as default};
