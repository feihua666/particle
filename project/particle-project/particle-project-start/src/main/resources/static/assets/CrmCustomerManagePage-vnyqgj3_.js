import{k as v,l as N}from"./crmCompItem-DK6SWanq.js";import{p as k}from"./crmCustomerManage-CYHLPyf3.js";import{d as B,r as b,a as D,b as r,o as y,c as R,e as n,w as s,f as w,F as M}from"./index-DoSQKVHz.js";import"./crmCustomerTagAdminApi-BwLtPg7c.js";import"./userCompItem-D0ziwGpi.js";import"./userAdminApi-BrVTPQqU.js";import"./deptCompItem-Cgt59Y8_.js";import"./deptTreeNameAdminApi-B9jKmPVM.js";const $=B({__name:"CrmCustomerManagePage",setup(A){const u=b(null),m=D({form:{},formComps:k,tableColumns:[{prop:"name",label:"客户名称"},{prop:"code",label:"客户编码"},{prop:"appellation",label:"客户称呼"},{prop:"typeDictName",label:"客户类型"},{prop:"genderDictName",label:"客户性别"},{prop:"age",label:"客户年龄"},{prop:"birthDay",label:"客户生日"},{prop:"crmCompanyName",label:"客户公司"},{prop:"crmDeptName",label:"客户部门"},{prop:"isBlack",label:"黑名单",formatter:(e,a,t,l)=>{let o=t?"是":"否";return!t&&e.blackReason&&(o=o+`(${e.blackReason})`),o}},{prop:"categoryDictName",label:"客户分类"},{prop:"belongUserNickname",label:"归属用户"},{prop:"belongCompName",label:"归属公司"},{prop:"belongDeptName",label:"归属部门"},{prop:"unionId",label:"合并到",formatter:(e,a,t,l)=>t||e.appellation},{prop:"remark",label:"备注"}]}),p=b({buttonText:"查询",loading:!1,permission:"admin:web:crmCustomer:pageQuery"}),c=()=>{u.value.refreshData()},d=({pageQuery:e})=>v({...m.form,...e}),f={permission:p.value.permission},g=({row:e,column:a,$index:t})=>t<0?[]:(e.id,[{txt:"联系方式管理",text:!0,permission:"admin:web:crmCustomerContact:pageQuery",route:{path:"/admin/crmCustomerContactManagePage",query:{crmCustomerId:e.id}}},{txt:"编辑",text:!0,permission:"admin:web:crmCustomer:update",route:{path:"/admin/CrmCustomerManageUpdate",query:{id:e.id,belongUserId:e.belongUserId,belongUserNickname:e.belongUserNickname}}},{txt:"删除",text:!0,permission:"admin:web:crmCustomer:delete",methodConfirmText:`确定要删除 ${e.name} 吗？`,method(){return N({id:e.id}).then(o=>(c(),Promise.resolve(o)))}}]);return(e,a)=>{const t=r("PtButton"),l=r("PtForm"),o=r("PtButtonGroup"),C=r("el-table-column"),_=r("PtTable"),P=r("PtRouteViewPopover");return y(),R(M,null,[n(l,{form:m.form,method:c,defaultButtonsShow:"submit,reset",submitAttrs:p.value,inline:"",labelWidth:"80",comps:m.formComps},{buttons:s(()=>[n(t,{permission:"admin:web:crmCustomer:create",route:"/admin/CrmCustomerManageAdd"},{default:s(()=>a[1]||(a[1]=[w("添加")])),_:1})]),_:1},8,["form","submitAttrs","comps"]),n(_,{ref_key:"tableRef",ref:u,"default-expand-all":"",dataMethod:d,onDataMethodDataLoading:a[0]||(a[0]=i=>p.value.loading=i),paginationProps:f,columns:m.tableColumns},{defaultAppend:s(()=>[n(C,{label:"操作",width:"180"},{default:s(({row:i,column:x,$index:h})=>[n(o,{options:g({row:i,column:x,$index:h})},null,8,["options"])]),_:1})]),_:1},8,["columns"]),n(P,{level:3})],64)}}});export{$ as default};
