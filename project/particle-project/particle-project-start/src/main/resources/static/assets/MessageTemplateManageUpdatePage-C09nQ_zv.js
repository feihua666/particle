import{b as P,d as S,e as h}from"./messageTemplateManage-BJvRSWpj.js";import{d as C,r as a,a as B,b as r,o as N,c as V,e as l,w as m,j as F,f as w,F as M,ar as p}from"./index-q46_oeYE.js";import{_ as O}from"./MessageTemplateContentDetailJson.vue_vue_type_style_index_0_lang-BTe_Wt8x.js";import"./treeQueryComps-CWIG2rsy.js";const A=C({__name:"MessageTemplateManageUpdatePage",props:{messageTemplateId:{type:String}},setup(c){const o=a(!1),i=a(null),u=c,n=B({form:{id:u.messageTemplateId,version:1},formData:{}}),d=a(P({contentDetailJsonDialogVisible:o})),f=a({buttonText:"确认修改",permission:"admin:web:messageTemplate:update"}),D=()=>S,b=()=>h({id:u.messageTemplateId}).then(t=>{let e=t.data.data.contentDetailJson;return e&&(s.value=JSON.parse(e)),Promise.resolve(t)}),J=()=>"修改成功，请刷新数据查看",s=a({}),g=()=>{let t=i.value.getContentDetailJsonData();if(p(t)||p(t.contentDetails)){n.form.contentDetailJson="",s.value={},o.value=!1;return}n.form.contentDetailJson=JSON.stringify(t),s.value=JSON.parse(JSON.stringify(t)),o.value=!1};return(t,e)=>{const v=r("PtForm"),_=r("PtButton"),T=r("el-dialog");return N(),V(M,null,[l(v,{form:n.form,formData:n.formData,labelWidth:"120",dataMethod:b,method:D(),methodSuccess:J,defaultButtonsShow:"submit,reset",submitAttrs:f.value,buttonsTeleportProps:t.$route.meta.formButtonsTeleportProps,inline:"",layout:[3,1,1,1,1,2,2,2,2,1],comps:d.value},null,8,["form","formData","method","submitAttrs","buttonsTeleportProps","comps"]),l(T,{modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=y=>o.value=y),width:"70%",title:"个性化内容详情配置","append-to-body":"","destroy-on-close":""},{footer:m(()=>[F("span",null,[l(_,{type:"primary",onClick:g},{default:m(()=>e[1]||(e[1]=[w("确认")])),_:1})])]),default:m(()=>[l(O,{ref_key:"contentDetailJsonRef",ref:i,initContentDetailJsonData:s.value},null,8,["initContentDetailJsonData"])]),_:1},8,["modelValue"])],64)}}});export{A as default};
