import{q as c,r as i}from"./roleFuncRelAdminApi-XlCMHKTB.js";import{r as p,a as f}from"./roleCompItem-D2GyP9bQ.js";import{d as h,a as I,r as a,t as b,b as F,o as P,g as M,n as v}from"./index-BAoWe_iC.js";import"./roleAdminApi-Cr7ujEw8.js";const g=h({__name:"RoleFuncRelManageRoleAssignFuncPage",props:{...p},setup(s){const n=s,t=I({form:{isLazyLoad:!0,uncheckedFuncIds:null},formData:{},dataMethodAllData:null}),l=a([f({props:n,required:!0}),{field:{name:"checkedFuncIds",value:[]},element:{comp:"PtTree",formItemProps:{label:"功能菜单",required:!0},compProps:({form:r})=>({dataInitMethod:({param:e})=>{let o=e.roleId;return o?c({id:o}):{data:[]}},dataInitMethodParam:{roleId:r.roleId},dataMethod:()=>b({includeTypeDictValues:"all"}).then(e=>(t.dataMethodAllData=e.data.data,Promise.resolve(e))),dataMethodResultHandleConvertToTree:!0,showCheckbox:!0})}}]),u=a({buttonText:"确认",permission:"admin:web:roleFuncRel:roleAssignFunc"}),m=r=>{let e=(t.dataMethodAllData||[]).map(o=>o.id);return t.form.uncheckedFuncIds=v(e,t.form.checkedFuncIds),i(r)},d=()=>"分配成功，请刷新数据查看";return(r,e)=>{const o=F("PtForm");return P(),M(o,{form:t.form,formData:t.formData,labelWidth:"80",method:m,methodSuccess:d,defaultButtonsShow:"submit,reset",submitAttrs:u.value,buttonsTeleportProps:r.$route.meta.formButtonsTeleportProps,inline:"",layout:1,comps:l.value},null,8,["form","formData","submitAttrs","buttonsTeleportProps","comps"])}}});export{g as default};
