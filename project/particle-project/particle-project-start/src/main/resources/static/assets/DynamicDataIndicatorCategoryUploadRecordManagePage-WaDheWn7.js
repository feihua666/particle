import{k as g,d as h,r as C,a as v,b as l,o as w,c as F,e as i,w as _,F as R,aw as U,ax as B,ay as N}from"./index-q46_oeYE.js";import{a as T,b as A}from"./dataCompItem-CdC2on3Q.js";import{e as M,d as k}from"./FileTools-Cx4MUywI.js";import"./dynamicTableAdminApi-_aC0aDyP.js";import"./dynamicDataCategoryAdminApi-iervXp7L.js";import"./dynamicDataIndicatorCategoryAdminApi-BPbj9E5v.js";let f="/admin/web/dynamic_data_indicator_category_upload_record";const O=a=>g.delete(f+"/delete",{data:a}),S=a=>g.get(f+"/page",{params:a}),V=a=>g.put(f+"/publish",a),G=[T({tips:"仅用来过滤指标分类，只选该项无查询过滤效果"}),A({}),{field:{name:"uploadFileName"},element:{comp:"el-input",formItemProps:{label:"上传文件名称"},compProps:{clearable:!0,placeholder:"模糊匹配"}}}],z=h({__name:"DynamicDataIndicatorCategoryUploadRecordManagePage",setup(a){const D=C(null),d=v({form:{},formComps:G,tableColumns:[{prop:"dynamicDataIndicatorCategoryName",label:"动态数据指标分类名称"},{prop:"uploadFileName",label:"上传文件名称",showOverflowTooltip:!0},{prop:"uploadFileUrl",label:"上传文件地址",showOverflowTooltip:!0},{prop:"uploadIndicatorNum",label:"上传指标数量"},{prop:"uploadIndicatorDataNum",label:"上传数据数量"},{prop:"isPublic",label:"是否发布",formatter:(e,m,o,c)=>o?"已发布":"未发布"}]}),s=C({buttonText:"查询",loading:!1,permission:"admin:web:dynamicDataIndicatorCategoryUploadRecord:pageQuery"}),p=()=>{D.value.refreshData()},P=({pageQuery:e})=>S({...d.form,...e}),x={permission:s.value.permission},I=({row:e,column:m,$index:o})=>o<0?[]:(e.id,[{txt:"下载导入文件",text:!0,permission:"adminDynamicDataIndicatorCategoryDownloadImportFile",method(){let t=U(e.uploadFileUrl),u=e.uploadFileName||B(t);return N(t).then(n=>{let r=n.data,b=M(n),y=decodeURIComponent(u);return k(r,b,y),Promise.resolve(n)})}},{txt:"导入数据管理",text:!0,position:"more",permission:"admin:web:dynamicDataIndicatorCategory:dataPageQuery",route:{path:"/admin/dynamicDataIndicatorCategoryUploadRecordManageData",query:{id:e.id,dynamicDataIndicatorCategoryId:e.dynamicDataIndicatorCategoryId}}},{txt:"发布数据",text:!0,position:"more",disabled:!!e.isPublic,disabledReason:e.isPublic?"当前数据已发布，不可重复发布":void 0,permission:"admin:web:dynamicDataIndicatorCategoryUploadRecord:publish",methodConfirmText:`确定要发布 ${e.uploadFileName} 吗？发布后对应导入的数据将会同步发布`,method(){return V({id:e.id}).then(t=>(p(),Promise.resolve(t)))}},{txt:"删除",text:!0,position:"more",permission:"admin:web:dynamicDataIndicatorCategoryUploadRecord:delete",methodConfirmText:`确定要删除 ${e.uploadFileName} 吗？删除后已导入的数据不受影响`,method(){return O({id:e.id}).then(t=>(p(),Promise.resolve(t)))}}]);return(e,m)=>{const o=l("PtForm"),c=l("PtButtonGroup"),t=l("el-table-column"),u=l("PtTable"),n=l("PtRouteViewPopover");return w(),F(R,null,[i(o,{form:d.form,method:p,defaultButtonsShow:"submit,reset",submitAttrs:s.value,inline:"",comps:d.formComps},null,8,["form","submitAttrs","comps"]),i(u,{ref_key:"tableRef",ref:D,"default-expand-all":"",dataMethod:P,onDataMethodDataLoading:m[0]||(m[0]=r=>s.value.loading=r),paginationProps:x,columns:d.tableColumns},{defaultAppend:_(()=>[i(t,{label:"操作",width:"220"},{default:_(({row:r,column:b,$index:y})=>[i(c,{options:I({row:r,column:b,$index:y}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),i(n,{level:3})],64)}}});export{z as default};
