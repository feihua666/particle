import{p as h,r as C}from"./dataScopeAdminApi-XW_rxl8n.js";import{p as D}from"./dataScopeManage-CU7A8gik.js";import{d as S,r as f,a as T,b as r,o as B,c as O,e as n,w as p,f as R,F as A}from"./index-DoSQKVHz.js";import"./dataconstraintCompItem-DyGpFQ6w.js";import"./dataObjectAdminApi-BUmMIlsy.js";const V=S({__name:"DataScopeManagePage",setup(F){const d=f(null),s=T({form:{},formComps:D,tableColumns:[{prop:"code",label:"编码",showOverflowTooltip:!0},{prop:"name",label:"名称",showOverflowTooltip:!0},{prop:"dataObjectName",label:"数据对象",showOverflowTooltip:!0},{prop:"constraintContentTypeDictName",label:"约束条件内容类型",showOverflowTooltip:!0},{prop:"constraintContent",label:"约束条件内容",showOverflowTooltip:!0},{prop:"isCustom",label:"自定义数据",formatter:(t,o,e,a)=>e?"是":"否"},{prop:"isForDelete",label:"用于删除",formatter:(t,o,e,a)=>e?"是":"否"},{prop:"isForUpdate",label:"用于修改",formatter:(t,o,e,a)=>e?"是":"否"},{prop:"isForQuery",label:"用于查询",formatter:(t,o,e,a)=>e?"是":"否"},{prop:"isForOther",label:"用于其它",formatter:(t,o,e,a)=>e?"是":"否"},{prop:"remark",label:"描述",showOverflowTooltip:!0}]}),l=f({buttonText:"查询",loading:!1,permission:"admin:web:dataScope:pageQuery"}),c=()=>{d.value.refreshData()},w=({pageQuery:t})=>h({...s.form,...t}),_={permission:l.value.permission},g=({row:t,column:o,$index:e})=>{if(e<0)return[];let a={id:t.id},i={dataScopeId:t.id,dataScopeName:t.name,dataObjectId:t.dataObjectId};return[{txt:"编辑",text:!0,permission:"admin:web:dataScope:update",route:{path:"/admin/DataScopeManageUpdate",query:a}},{txt:"删除",text:!0,position:"more",permission:"admin:web:dataScope:delete",methodConfirmText:`确定要删除 ${t.name} 吗？`,method(){return C({id:t.id}).then(m=>(c(),Promise.resolve(m)))}},{txt:"数据范围分配自定义数据",position:"more",disabled:!t.isCustom,disabledReason:t.isCustom?void 0:"只有自定义数据范围才能分配自定义数据",text:!0,permission:"admin:web:dataScopeCustomDataRel:dataScopeAssignCustomData",route:{path:"/admin/dataScopeManageDataScopeAssignCustomData",query:i}}]};return(t,o)=>{const e=r("PtButton"),a=r("PtForm"),i=r("PtButtonGroup"),b=r("el-table-column"),m=r("PtTable"),x=r("PtRouteViewPopover");return B(),O(A,null,[n(a,{form:s.form,method:c,defaultButtonsShow:"submit,reset",submitAttrs:l.value,inline:"",comps:s.formComps},{buttons:p(()=>[n(e,{permission:"admin:web:dataScope:create",route:"/admin/DataScopeManageAdd"},{default:p(()=>o[1]||(o[1]=[R("添加")])),_:1})]),_:1},8,["form","submitAttrs","comps"]),n(m,{ref_key:"tableRef",ref:d,"default-expand-all":"",dataMethod:w,onDataMethodDataLoading:o[0]||(o[0]=u=>l.value.loading=u),paginationProps:_,columns:s.tableColumns},{defaultAppend:p(()=>[n(b,{label:"操作",width:"180"},{default:p(({row:u,column:v,$index:P})=>[n(i,{options:g({row:u,column:v,$index:P}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),n(x,{level:3})],64)}}});export{V as default};
