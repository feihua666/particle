import{c as _}from"./dictAdminApi-DqSLDXRM.js";import{b as D}from"./dictManage-Y030Ocad.js";import{d as S,a as B,r as m,b as C,o as M,g as T,i as q,h as w,E as F}from"./index-q46_oeYE.js";import"./treeQueryComps-CWIG2rsy.js";const N=S({__name:"DictManageBatchAddPage",props:{parentId:{type:String}},setup(p){let f=(e,o="success")=>{F({showClose:!0,message:e,type:o,showIcon:!0,grouping:!0})};const u=B({form:{parentId:p.parentId},formData:{}}),l=[],d=m(D),h=m({buttonText:"确认批量添加",permission:"admin:web:dict:create"}),b=e=>{l.splice(0,l.length);let t=e.batchContent.split(`
`);if(t.length==0)return"批量添加内容格式不正确,未获取到数据";let n=e.isGroup,r=e.isItem,s=0;if(n&&r)s=3;else if(n&&!r)s=2;else if(!n&&r)s=2;else return"一个字典至少为字典组或字典项";for(let a=0;a<t.length;a++){let c=t[a].split(" ");if(c.length!=s)return"批量添加内容格式不正确,应为 "+s+" 列数据";let i=g(c,n,r);i&&l.push(i)}return!0},g=(e,o,t)=>o&&t?{code:e[0],name:e[1],value:e[2]}:o&&!t?{code:e[0],name:e[1],value:null}:!o&&t?{code:null,name:e[0],value:e[1]}:null,v=e=>{let o=b(e);if(o!==!0)return q(o)&&f(o,"error"),!1;let t=e.seq;const n=l.map(r=>{let s=w(e);return s.code=r.code,s.name=r.name,s.value=r.value,t+=100,s.seq=t,_(s)});return Promise.all(n)},P=()=>"批量添加成功，请刷新数据查看";return(e,o)=>{const t=C("PtForm");return M(),T(t,{form:u.form,formData:u.formData,labelWidth:"100",method:v,methodSuccess:P,defaultButtonsShow:"submit,reset",submitAttrs:h.value,inline:"",buttonsTeleportProps:e.$route.meta.formButtonsTeleportProps,layout:[3,3,3,3,3,3,1,1],comps:d.value},null,8,["form","formData","submitAttrs","buttonsTeleportProps","comps"])}}});export{N as default};
