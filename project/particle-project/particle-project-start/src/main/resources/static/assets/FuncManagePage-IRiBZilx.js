import{d as w,r as b,a as T,a1 as B,b as a,o as M,c as A,e as n,w as u,f as g,F as y,a2 as F,a3 as R,a4 as D}from"./index-CmUqrYxc.js";import{p as V}from"./funcManage-C2rkfyOa.js";import"./treeQueryComps-CWIG2rsy.js";const S=w({__name:"FuncManagePage",setup(k){const c=b(null),r=T({form:{},formComps:V,tableColumns:B}),d=b({buttonText:"查询",loading:!1,permission:"admin:web:func:pageQuery"}),p=()=>{c.value.refreshData()},_=({pageQuery:e})=>F({...r.form,...e}),P={permission:d.value.permission},x=({row:e,column:t,$index:m})=>{if(m<0)return[];let s={id:e.id},i=[{txt:"添加子级",text:!0,permission:"admin:web:func:create",route:{path:"/admin/funcManageAdd",query:s}},{txt:"编辑",position:"more",text:!0,permission:"admin:web:func:update",route:{path:"/admin/funcManageUpdate",query:s}},{txt:"复制",text:!0,position:"more",permission:"admin:web:func:copy",methodConfirmText:`确定要复制 ${e.name} 吗？`,methodSuccess:o=>{r.form.name=o.data.data.name,p()},method(){return R({id:e.id}).then(o=>Promise.resolve(o))}},{txt:"删除",position:"more",text:!0,permission:"admin:web:func:delete",methodConfirmText:`确定要删除 ${e.name} 吗？`,method(){return D({id:e.id}).then(o=>(p(),Promise.resolve(o)))}}];return e.typeDictValue=="page"&&i.push({txt:"添加Crud",position:"more",text:!0,permission:"admin:web:func:create",route:{path:"/admin/funcManageCrudAdd",query:s}}),i};return(e,t)=>{const m=a("PtButton"),s=a("PtForm"),i=a("PtButtonGroup"),f=a("el-table-column"),o=a("PtTable"),h=a("PtRouteViewPopover");return M(),A(y,null,[n(s,{form:r.form,method:p,defaultButtonsShow:"submit,reset",submitAttrs:d.value,inline:"",comps:r.formComps},{buttons:u(()=>[n(m,{permission:"admin:web:func:create",route:"/admin/funcManageAdd"},{default:u(()=>t[1]||(t[1]=[g("添加")])),_:1}),n(m,{permission:"admin:web:func:create",route:"/admin/funcManageCrudAdd"},{default:u(()=>t[2]||(t[2]=[g("添加Crud")])),_:1})]),_:1},8,["form","submitAttrs","comps"]),n(o,{ref_key:"tableRef",ref:c,"default-expand-all":"",dataMethod:_,onDataMethodDataLoading:t[0]||(t[0]=l=>d.value.loading=l),dataMethodResultHandleConvertToTree:!0,paginationProps:P,columns:r.tableColumns},{defaultAppend:u(()=>[n(f,{label:"操作",width:"220"},{default:u(({row:l,column:C,$index:v})=>[n(i,{options:x({row:l,column:C,$index:v}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),n(h,{level:3})],64)}}});export{S as default};
