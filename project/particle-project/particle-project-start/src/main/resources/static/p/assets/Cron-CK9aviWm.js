import{_ as U,h,C as v,b as x,o as l,c as u,e as o,w as i,j as E,f as d,F as s,D as y,g,G as b,H as q,I as _,E as B,J as w}from"./index-BIT85eDf.js";import{c as S}from"./toolsFrontApi-BkRCjOPd.js";const k=(e,t="success")=>{B({showClose:!0,message:e,type:t,showIcon:!0,grouping:!0})};let z={per:()=>"*",range:e=>e.join("-"),perRange:e=>e.join("/"),fixed:e=>{let t=h(e);return t.sort(),t.join(",")},lastDay:()=>"L",lastWorkDay:()=>"LW",perRangeWorkDay:e=>{let t=e;return w(t)&&(t=e[0]),t+"W"},no:()=>"?",fixedRange:e=>e.join("#"),lastWk:e=>{let t=e;return w(t)&&(t=e[0]),t+"L"},noSet:e=>""},N=[{type:"second",index:0,tabLabel:"秒",radioValue:"per",radios:[{type:"text",txt:"每秒 允许的通配符[, - * /]",radioLabel:"per"},{type:"range",txt:["周期从 ",{type:"inputNumber",props:{min:0,max:59},dataValueIndex:0}," - ",{type:"inputNumber",props:{min:0,max:59},dataValueIndex:1}," 秒"],radioLabel:"range",dataValue:[0,1]},{type:"range",txt:["从 ",{type:"inputNumber",props:{min:0,max:59},dataValueIndex:0}," 秒开始，每 ",{type:"inputNumber",props:{min:0,max:59},dataValueIndex:1}," 秒执行一次"],radioLabel:"perRange",dataValue:[0,1]},{type:"fixed",txt:"指定",range:[0,59],radioLabel:"fixed",dataValue:[0,1]}]},{type:"minute",index:1,tabLabel:"分",radioValue:"per",radios:[{type:"text",txt:"每分 允许的通配符[, - * /]",radioLabel:"per"},{type:"range",txt:["周期从 ",{type:"inputNumber",props:{min:0,max:59},dataValueIndex:0}," - ",{type:"inputNumber",props:{min:0,max:59},dataValueIndex:1}," 分"],radioLabel:"range",dataValue:[0,1]},{type:"range",txt:["从 ",{type:"inputNumber",props:{min:0,max:59},dataValueIndex:0}," 分开始，每 ",{type:"inputNumber",props:{min:0,max:59},dataValueIndex:1}," 分执行一次"],radioLabel:"perRange",dataValue:[0,1]},{type:"fixed",txt:"指定",range:[0,59],radioLabel:"fixed",dataValue:[0,1]}]},{type:"hour",index:2,tabLabel:"时",radioValue:"per",radios:[{type:"text",txt:"每小时 允许的通配符[, - * /]",radioLabel:"per"},{type:"range",txt:["周期从 ",{type:"inputNumber",props:{min:0,max:23},dataValueIndex:0}," - ",{type:"inputNumber",props:{min:0,max:23},dataValueIndex:1}," 小时"],radioLabel:"range",dataValue:[0,1]},{type:"range",txt:["从 ",{type:"inputNumber",props:{min:0,max:23},dataValueIndex:0}," 小时开始，每 ",{type:"inputNumber",props:{min:0,max:23},dataValueIndex:1}," 小时执行一次"],radioLabel:"perRange",dataValue:[0,1]},{type:"fixed",txt:"指定",range:[0,23],radioLabel:"fixed",dataValue:[0,1]}]},{type:"day",index:3,tabLabel:"日",radioValue:"per",radios:[{type:"text",txt:"每日 允许的通配符[, - * / L W]",radioLabel:"per"},{type:"range",txt:["周期从 ",{type:"inputNumber",props:{min:0,max:31},dataValueIndex:0}," - ",{type:"inputNumber",props:{min:0,max:31},dataValueIndex:1}," 日"],radioLabel:"range",dataValue:[0,1]},{type:"range",txt:["从 ",{type:"inputNumber",props:{min:0,max:23},dataValueIndex:0}," 日开始，每 ",{type:"inputNumber",props:{min:0,max:23},dataValueIndex:1}," 日执行一次"],radioLabel:"perRange",dataValue:[0,1]},{type:"fixed",txt:"指定",range:[0,31],radioLabel:"fixed",dataValue:[0,1]},{type:"text",txt:"本月最后一天",radioLabel:"lastDay"},{type:"text",txt:"本月最后一个工作日",radioLabel:"lastWorkDay"},{type:"range",txt:["每月 ",{type:"inputNumber",props:{min:1,max:31},dataValueIndex:0}," 号最近的那个工作日"],radioLabel:"perRangeWorkDay",dataValue:[1]},{type:"text",txt:"不指定",radioLabel:"no"}]},{type:"month",index:4,tabLabel:"月",radioValue:"per",radios:[{type:"text",txt:"每月 允许的通配符[, - * /]",radioLabel:"per"},{type:"range",txt:["周期从 ",{type:"inputNumber",props:{min:1,max:12},dataValueIndex:0}," - ",{type:"inputNumber",props:{min:1,max:12},dataValueIndex:1}," 月"],radioLabel:"range",dataValue:[1,2]},{type:"range",txt:["从 ",{type:"inputNumber",props:{min:1,max:12},dataValueIndex:0}," 月开始，每 ",{type:"inputNumber",props:{min:1,max:12},dataValueIndex:1}," 月执行一次"],radioLabel:"perRange",dataValue:[0,1]},{type:"fixed",txt:"指定",range:[1,12],radioLabel:"fixed",dataValue:[1,2]}]},{type:"week",index:5,tabLabel:"周",radioValue:"no",radios:[{type:"text",txt:"每周 允许的通配符[, - * / L #]",radioLabel:"per"},{type:"range",txt:["周期从星期 ",{type:"inputNumber",props:{min:1,max:7},dataValueIndex:0}," - 星期",{type:"inputNumber",props:{min:1,max:7},dataValueIndex:1}],radioLabel:"range",dataValue:[1,2]},{type:"range",txt:["每月第 ",{type:"inputNumber",props:{min:1,max:4},dataValueIndex:0}," 周的星期 ",{type:"inputNumber",props:{min:1,max:12},dataValueIndex:1}],radioLabel:"fixedRange",dataValue:[1,1]},{type:"fixed",txt:"指定",range:[1,7],radioLabel:"fixed",dataValue:[1,2]},{type:"range",txt:["本月最后一个星期 ",{type:"inputNumber",props:{min:1,max:7},dataValueIndex:0}],radioLabel:"lastWk",dataValue:[1]},{type:"text",txt:"不指定",radioLabel:"no"}]},{type:"year",index:6,tabLabel:"年",radioValue:"noSet",radios:[{type:"text",txt:"每年 允许的通配符[, - * /] 非必填",radioLabel:"per"},{type:"range",txt:["周期从 ",{type:"inputNumber",props:{},dataValueIndex:0},"年 - ",{type:"inputNumber",props:{},dataValueIndex:1},"年"],radioLabel:"range",dataValue:[new Date().getFullYear(),new Date().getFullYear()+2]},{type:"range",txt:["从 ",{type:"inputNumber",props:{},dataValueIndex:0}," 年开始，每 ",{type:"inputNumber",props:{},dataValueIndex:1}," 年执行一次"],radioLabel:"perRange",dataValue:[new Date().getFullYear(),2]},{type:"fixed",txt:"指定",range:[new Date().getFullYear(),new Date().getFullYear()+59],radioLabel:"fixed",dataValue:[new Date().getFullYear()]},{type:"text",txt:"不指定,忽略该位",radioLabel:"noSet"}]}],Y=[["0 0 2 1 * ?","表示在每月的1日的凌晨2点触发"],["0 15 10 ? * MON-FRI","表示周一到周五每天上午10:15触发"],["0 15 10 ? 6L 2002-2006","表示2002-2006年的每个月的最后一个星期五上午10:15触发"],["0 0 10,14,16 * * ?","每天上午10点，下午2点，4点触发"],["0 0/30 9-17 * * ?","朝九晚五工作时间内每半小时触发"],["0 0 12 ? * WED","表示每个星期三中午12点触发"],["0 0 12 * * ?","每天中午12点触发"],["0 15 10 ? * *","每天上午10:15触发"],["0 15 10 * * ?","每天上午10:15触发"],["0 15 10 * * ? *","每天上午10:15触发"],["0 15 10 * * ? 2005","2005年的每天上午10:15触发"],["0 * 14 * * ?","在每天下午2点到下午2:59期间的每1分钟触发"],["0 0/5 14 * * ?","在每天下午2点到下午2:55期间的每5分钟触发 "],["0 0/5 14,18 * * ?","在每天下午2点到2:55期间和下午6点到6:55期间的每5分钟触发"],["0 0-5 14 * * ?","在每天下午2点到下午2:05期间的每1分钟触发"],["0 10,44 14 ? 3 WED","每年三月的星期三的下午2:10和2:44触发"],["0 15 10 ? * MON-FRI","周一至周五的上午10:15触发"],["0 15 10 15 * ?","每月15日上午10:15触发"],["0 15 10 L * ?","每月最后一日的上午10:15触发"],["0 15 10 ? * 6L","每月的最后一个星期五上午10:15触发"],["0 15 10 ? * 6L 2002-2005","2002年至2005年的每月的最后一个星期五上午10:15触发"],["0 15 10 ? * 6#3","每月的第三个星期五上午10:15触发"]];const M={name:"Cron",components:{},props:{},computed:{resultTxt(){let e=[];for(let t in this.result)this.result[t]!==""&&e.push(this.result[t]);return e.join(" ")}},data(){return{activeName:"second",uiData:h(N),resultTxtValue:"",runtimes:10,runtimesResult:[],getRunTimesLoading:!1,quickData:Y,quickDataValue:"",result:{second:"",minute:"",hour:"",day:"",month:"",week:"",year:""}}},mounted(){this.$_parseValue()},methods:{isObject(e){return v(e)},$_getRangeArray(e){let t=[];for(let V=e[0];V<=e[1];V++)t.push(V);return t},$_prependZero(e){return e<10?"0"+e:e},$_parseValue(){this.uiData.forEach(e=>{e.radios.filter(t=>t.radioLabel==e.radioValue).forEach(t=>{this.result[e.type]=z[t.radioLabel](t.dataValue)})})},$_okSetting(){this.$emit("okSetting",this.resultTxtValue)},resetByDefine(e){e?N.filter(t=>t.type==e).forEach(t=>{this.uiData.splice(t.index,1,t)}):(this.activeName="second",this.uiData=h(N))},getRunTimes(){if(!this.getRunTimesLoading){if(this.resultTxtValue.split(" ").length==7){k("计算运行时间不支持年","warning"),this.runtimesResult=[];return}this.getRunTimesLoading=!0,S({cronExpression:this.resultTxtValue,times:this.runtimes}).then(e=>{this.runtimesResult=e.data.data}).catch(e=>{e.response?e.response.data&&e.response.data.errorMsg&&k(e.response.data.errorMsg,"error"):k("网络错误或服务不可用","error")}).finally(()=>{this.getRunTimesLoading=!1})}}},watch:{uiData:{deep:!0,handler(){this.$_parseValue()}},resultTxt(e){this.$emit("change",e),this.resultTxtValue=e,this.getRunTimes()},quickDataValue(e){this.$emit("change",e),this.resultTxtValue=e,this.getRunTimes()},runtimes(){this.getRunTimes()}}},O={class:"pt-el-cron"},A={key:0};function P(e,t,V,Z,p,m){const f=x("el-button"),D=x("el-input"),C=x("el-input-number"),j=x("el-checkbox"),I=x("el-checkbox-group"),R=x("el-radio"),T=x("el-tab-pane"),W=x("el-tabs"),F=x("el-slider");return l(),u("div",O,[o(D,{size:"small",modelValue:p.resultTxtValue,"onUpdate:modelValue":t[0]||(t[0]=a=>p.resultTxtValue=a),readonly:""},{default:i(()=>[t[6]||(t[6]=E("template",{slot:"prepend"},[d("cron表达式：")],-1)),o(f,{slot:"append",onClick:m.$_okSetting,type:"primary"},{default:i(()=>t[5]||(t[5]=[d("确定")])),_:1},8,["onClick"])]),_:1},8,["modelValue"]),o(W,{modelValue:p.activeName,"onUpdate:modelValue":t[3]||(t[3]=a=>p.activeName=a),type:"card"},{default:i(()=>[(l(!0),u(s,null,y(p.uiData,a=>(l(),g(T,{key:a.type,label:a.tabLabel,name:a.type},{default:i(()=>[(l(!0),u(s,null,y(a.radios,(r,c)=>(l(),g(R,{key:c,class:"radio-block",modelValue:a.radioValue,"onUpdate:modelValue":n=>a.radioValue=n,label:r.radioLabel},{default:i(()=>[r.type=="text"?(l(),u(s,{key:0},[d(b(r.txt),1)],64)):r.type=="range"?(l(!0),u(s,{key:1},y(r.txt,n=>(l(),u(s,null,[typeof n=="string"?(l(),u(s,{key:0},[d(b(n),1)],64)):m.isObject(n)&&n.type=="inputNumber"?(l(),g(C,q({key:1,modelValue:r.dataValue[n.dataValueIndex],"onUpdate:modelValue":L=>r.dataValue[n.dataValueIndex]=L,ref_for:!0},n.props,{size:"small"}),null,16,["modelValue","onUpdate:modelValue"])):_("",!0)],64))),256)):r.type=="fixed"?(l(),u(s,{key:2},[d(b(r.txt)+" ",1),o(I,{style:{"margin-left":"30px"},modelValue:r.dataValue,"onUpdate:modelValue":n=>r.dataValue=n},{default:i(()=>[(l(!0),u(s,null,y(m.$_getRangeArray(r.range),(n,L)=>(l(),u(s,null,[o(j,{label:n},{default:i(()=>[d(b(m.$_prependZero(n)),1)]),_:2},1032,["label"]),(L+1)%10==0?(l(),u("br",A)):_("",!0)],64))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"])],64)):_("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue","label"]))),128)),o(f,{onClick:r=>m.resetByDefine(a.type),size:"small"},{default:i(()=>t[7]||(t[7]=[d("重置当前项")])),_:2},1032,["onClick"]),t[9]||(t[9]=d()),o(f,{onClick:t[1]||(t[1]=r=>m.resetByDefine()),size:"small"},{default:i(()=>t[8]||(t[8]=[d("全部重置")])),_:1})]),_:2},1032,["label","name"]))),128)),o(T,{name:"quick",label:"常用表达式"},{default:i(()=>[(l(!0),u(s,null,y(p.quickData,(a,r)=>(l(),g(R,{class:"radio-block",modelValue:p.quickDataValue,"onUpdate:modelValue":t[2]||(t[2]=c=>p.quickDataValue=c),label:a[0],key:r},{default:i(()=>[d(b(a.join("   ")),1)]),_:2},1032,["modelValue","label"]))),128))]),_:1})]),_:1},8,["modelValue"]),o(F,{size:"small",modelValue:p.runtimes,"onUpdate:modelValue":t[4]||(t[4]=a=>p.runtimes=a),step:5,min:5,"show-input":"","show-stops":"","format-tooltip":a=>`模拟运行${a}次`},null,8,["modelValue","format-tooltip"]),o(D,{size:"small",class:"pt-margin-top-30-px",rows:"20",value:p.runtimesResult.join(`
`),readonly:"",type:"textarea",placeholder:"触发时间展示区"},null,8,["value"])])}const H=U(M,[["render",P],["__scopeId","data-v-e441a7fd"]]);export{H as default};
