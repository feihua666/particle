import{t as T,b as R}from"./reportReportApiAdminApi-D-0ZmUPu.js";import{d as g,a as w,r as m,b as a,o as x,c as C,e as s,w as A,f as _,F as y,E as O,Q as j}from"./index-DMP92Tz2.js";const M=g({__name:"ReportReportApiManageTestPage",props:{reportReportApiId:{type:String}},setup(l){let n=(e,t="success")=>{O({showClose:!0,message:e,type:t,showIcon:!0,grouping:!0})};const p=l,o=w({form:{url:""},formData:{},testResult:{value:""}}),u=m([{field:{name:"param"},element:{comp:"el-input",formItemProps:{label:"参数",displayBlock:!0},compProps:{type:"textarea",rows:15}}},{field:{name:"isConvertParamToObj",value:!0},element:{comp:"el-switch",formItemProps:{label:"将参数转为对象后提交"},compProps:{activeText:"转为json对象",inactiveText:"保持字符串"}}}]),i=m({buttonText:"查询",permission:"admin:web:reportReportApi:test",beforeMethod:()=>{let e=o.form.isConvertParamToObj,t=o.form.param;if(e&&t)try{t=JSON.parse(t)}catch{n("参数格式错误，请检查！","error");return}return!0}}),c=e=>{let t=j(e);if(t.isConvertParamToObj&&t.param)try{t.param=JSON.parse(t.param)}catch{n("参数格式错误，请检查！","error");return}return T(t)},d=()=>R({id:p.reportReportApiId}).then(e=>(o.form.param=e.data.data.inParamExampleConfigJson,Promise.resolve(e))),f=e=>{let t=e.data;return o.testResult.value=JSON.stringify(t,null,"   "),"数据查询成功"},b=()=>{o.testResult.value=""};return(e,t)=>{const r=a("PtForm"),v=a("el-text"),P=a("PtAceEditor");return x(),C(y,null,[s(r,{form:o.form,formData:o.formData,labelWidth:"100",dataMethod:d,method:c,methodSuccess:f,defaultButtonsShow:"submit,reset",submitAttrs:i.value,buttonsTeleportProps:e.$route.meta.formButtonsTeleportProps,onResetForm:b,inline:"",layout:1,comps:u.value},null,8,["form","formData","submitAttrs","buttonsTeleportProps","comps"]),s(v,{type:"warning"},{default:A(()=>t[1]||(t[1]=[_("注意：如有修改模板或接口请刷新缓存后再测试")])),_:1}),s(P,{modelValue:o.testResult.value,"onUpdate:modelValue":t[0]||(t[0]=h=>o.testResult.value=h),mode:"ace/mode/json",class:"pt-width-100-pc"},null,8,["modelValue"])],64)}}});export{M as default};
