import{p as y,t as R,a as v,r as w}from"./openplatformOpenapiBatchQueryRecordAdminApi--R4XWjMz.js";import{d as D,r as h,a as C,b as a,o as F,c as O,e as n,w as x,F as Q,aw as T,ax as A,ay as U}from"./index-COCB7OXO.js";import{e as V,d as I}from"./FileTools-Cx4MUywI.js";import"./openplatformAppCompItem-tWuPSa1Q.js";import"./openplatformAppAdminApi-DeGnomx9.js";import"./openplatformOpenapiCompItem-CQEImHVk.js";import"./crmCompItem-BS97tqiH.js";import"./crmCustomerTagAdminApi-CTtJwd4-.js";const $=D({__name:"OpenplatformOpenapiBatchQueryRecordManagePage",setup(M){const c=h(null),r=C({form:{},formComps:y,tableColumns:R}),l=h({buttonText:"查询",loading:!1,permission:"admin:web:openplatformOpenapiBatchQueryRecord:pageQuery"}),f=()=>{c.value.refreshData()},_=({pageQuery:e})=>v({...r.form,...e}),B={permission:l.value.permission},g=({row:e,column:i,$index:s})=>{if(s<0)return[];e.id;let p={openplatformOpenapiBatchQueryRecordId:e.id};return[{txt:"下载",text:!0,disabled:e.executeStatusDictValue!="finished",disabledReason:e.executeStatusDictValue!="finished"?"执行完成后才可能下载":void 0,method(){let o=T(e.exportFileUrl),m=A(o);return U(o).then(t=>{let u=t.data,d=V(t),P=decodeURIComponent(m);return I(u,d,P),Promise.resolve(t)})}},{txt:"查看详情",text:!0,position:"more",permission:"admin:web:openplatformOpenapiBatchQueryRecordDetail:pageQuery",route:{path:"/admin/openplatformOpenapiBatchQueryRecordDetail",query:p}},{txt:"删除",text:!0,position:"more",permission:"admin:web:openplatformOpenapiBatchQueryRecord:delete",methodConfirmText:`确定要删除 ${e.name} 吗？`,method(){return w({id:e.id}).then(o=>(f(),Promise.resolve(o)))}}]};return(e,i)=>{const s=a("PtForm"),p=a("PtButtonGroup"),b=a("el-table-column"),o=a("PtTable"),m=a("PtRouteViewPopover");return F(),O(Q,null,[n(s,{form:r.form,method:f,defaultButtonsShow:"submit,reset",submitAttrs:l.value,inline:"",labelWidth:"80",comps:r.formComps},null,8,["form","submitAttrs","comps"]),n(o,{ref_key:"tableRef",ref:c,"default-expand-all":"",dataMethod:_,onDataMethodDataLoading:i[0]||(i[0]=t=>l.value.loading=t),paginationProps:B,columns:r.tableColumns},{defaultAppend:x(()=>[n(b,{label:"操作",width:"180"},{default:x(({row:t,column:u,$index:d})=>[n(p,{options:g({row:t,column:u,$index:d}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),n(m,{level:3})],64)}}});export{$ as default};
