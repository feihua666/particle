import{k as r,E as v}from"./index-COCB7OXO.js";import{l as c}from"./dataQueryDatasourceAdminApi-uWqxzemP.js";import{u as d}from"./dataqueryProviderCompItem-mdBVEThF.js";const o="/admin/web/data_query_datasource_api",$=e=>r.post(o+"/create",e),H=e=>r.post(o+"/copy",e),L=e=>r.post(o+"/copydev",e),O=e=>r.put(o+"/devMergeToMaster",e),z=e=>r.delete(o+"/delete",{data:e}),G=e=>r.delete(o+"/deleteCache",{data:e}),K=e=>r.put(o+"/refreshCache",e),W=e=>r.put(o+"/update",e),X=e=>r.get(o+"/detail-for-update",{params:e}),Y=e=>r.get(o+"/list",{params:e}),Z=e=>r.get(o+"/page",{params:e}),x=o+"/test",A=e=>r.post(x+"/api_test",e),F=e=>r.get(o+"/detail",{params:e}),h=(e,a="success")=>{v({showClose:!0,message:e,type:a,showIcon:!0,grouping:!0})},i={object:"object",array:"array",string:"string",number:"number",float:"float",boolean:"boolean",queryString:"queryString"},Q={[i.object]:e=>JSON.parse(e),[i.array]:e=>JSON.parse(e),[i.string]:e=>e,[i.number]:e=>parseInt(e),[i.float]:e=>parseFloat(e),[i.boolean]:e=>e=="true"?!0:e=="false"?!1:null,[i.queryString]:e=>e},y=(e,{tips:a=""}={})=>({field:{name:"inParamExampleConfigJson"},element:{comp:"PtButton",formItemProps:{label:"入参示例",tips:a||"对接口的请求示例，仅做参考，不做为逻辑处理依据，表示接收的参数示例"},compProps:({form:t})=>({text:!0,type:t.inParamExampleConfigJson?"primary":"default",buttonText:"点击配置",method:()=>{e.value&&(e.value.reactiveData.inParamExampleConfigJson.dialogVisible=!0)}})}}),T=(e,{tips:a=""}={})=>({field:{name:"inParamTestCaseDataConfigJson"},element:{comp:"PtButton",formItemProps:{label:"入参测试用例数据",tips:a||"对接口的请求标识数据，为做接口测试时，提供准确的依据"},compProps:({form:t,formData:l})=>({text:!0,type:t.inParamTestCaseDataConfigJson?"primary":"default",buttonText:"点击配置",method:()=>{e.value&&(e.value.reactiveData.inParamTestCaseDataConfigJson.dialogVisible=!0)}})}}),J=(e,{tips:a=""}={})=>({field:{name:"inParamDocConfigJson"},element:{comp:"PtButton",formItemProps:{label:"入参文档配置",tips:a||"对接口的参数字段说明，表示在基本配置中接口或本地方法接收的参数文档说明"},compProps:({form:t,formData:l})=>({text:!0,type:t.inParamDocConfigJson?"primary":"default",buttonText:"点击配置",beforeMethod:()=>t.inParamTypeDictId?!0:"请先选择入参类型",method:()=>{e.value&&(e.value.reactiveData.inParamDoc.dialogVisible=!0)}})}}),C=(e,{tips:a=""}={})=>({field:{name:"outParamExampleConfigJson"},element:{comp:"PtButton",formItemProps:{label:"出参示例",tips:a||"表示在出参类型的基础上对接口的响应示例，仅做参考，不做为逻辑处理依据"},compProps:({form:t})=>({text:!0,type:t.outParamExampleConfigJson?"primary":"default",buttonText:"点击配置",method:()=>{e.value&&(e.value.reactiveData.outParamExampleConfigJson.dialogVisible=!0)}})}}),D=(e,{tips:a=""}={})=>({field:{name:"outParamDocConfigJson"},element:{comp:"PtButton",formItemProps:{label:"出参文档配置",tips:a||"表示在出参类型的基础上对接口的参数字段说明"},compProps:({form:t,formData:l})=>({text:!0,type:t.outParamDocConfigJson?"primary":"default",buttonText:"点击配置",beforeMethod:()=>t.outParamTypeDictId?!0:"请先选择出参类型",method:()=>{e.value&&(e.value.reactiveData.outParamDoc.dialogVisible=!0)}})}}),_=(e,{tips:a=""}={})=>({field:{name:"inParamValidateConfigJson"},element:{comp:"PtButton",formItemProps:{label:"入参校验配置",tips:a||"入参的校验规则，逻辑处理,支持多个配置，有一个校验失败表示失败，不配置代表不校验，表示对参数的校验"},compProps:({form:t,formData:l})=>({text:!0,type:t.inParamValidateConfigJson?"primary":"default",buttonText:"点击配置",method:()=>{e.value&&(e.value.reactiveData.inParamValidate.dialogVisible=!0)}})}}),I=e=>({field:{name:"inParamExtConfigJson"},element:{comp:"PtButton",formItemProps:{label:"入参扩展配置",tips:"扩展配置支持，针对不同的接口可能有更个性的配置，主要用来处理请求参数，该配置在基本配置之前执行"},compProps:({form:a,formData:t})=>({text:!0,type:a.inParamExtConfigJson?"primary":"default",buttonText:"点击配置",method:()=>{e.value&&(e.value.reactiveData.inParamExtConfigJson.dialogVisible=!0)}})}}),S=(e,{tips:a=""}={})=>({field:{name:"outParamSuccessConfigJson"},element:{comp:"PtButton",formItemProps:{label:"出参结果成功或失败配置",tips:a||"表示在出参类型的基础上对该出参做一个成功或失败的判断，以处理告警或其它需要的逻辑，不配置代表都成功"},compProps:({form:t})=>({text:!0,type:t.outParamSuccessConfigJson?"primary":"default",buttonText:"点击配置",method:()=>{e.value&&(e.value.reactiveData.outParamSuccess.dialogVisible=!0)}})}}),q=e=>({field:{name:"outParamExtConfigJson"},element:{comp:"PtButton",formItemProps:{label:"出参扩展配置",tips:'扩展配置支持，针对不同的接口可能有更个性的配置，主要用来处理返回结果，额外支持datasourceApi调用数据源接口和dataQueryDataApiExecutor线程池句柄,支持设置业务状态码如：ext.put("responseBusinessStatus","200")'},compProps:({form:a,formData:t})=>({text:!0,type:a.outParamExtConfigJson?"primary":"default",buttonText:"点击配置",method:()=>{e.value&&(e.value.reactiveData.outParamExtConfigJson.dialogVisible=!0)}})}}),V=(e,{tips:a=""}={})=>({field:{name:"outParamTransConfigJson"},element:{comp:"PtButton",formItemProps:{label:"出参翻译配置",tips:a||"针对响应数数据翻译数据字典支持,翻译执行在出参扩展配置之后执行"},compProps:({form:t})=>({text:!0,type:t.outParamTransConfigJson?"primary":"default",buttonText:"点击配置",method:()=>{e.value&&(e.value.reactiveData.outParamTransConfig.dialogVisible=!0)}})}}),E=(e,{tips:a=""}={})=>({field:{name:"dictConfigJson"},element:{comp:"PtButton",formItemProps:{label:"字典配置",tips:a||"接口用到的字典数据配置，可配合文档和翻译等使用"},compProps:({form:t})=>({text:!0,type:t.dictConfigJson?"primary":"default",buttonText:"点击配置",method:()=>{e.value&&(e.value.reactiveData.dictConfig.dialogVisible=!0)}})}}),M=(e,{tips:a=""}={})=>({field:{name:"pageableAdapterConfigJson"},element:{comp:"PtButton",formItemProps:{label:"分页信息配置",tips:a||"用来解析分页请求和响应数据转换，仅适用于分页查询使用，主要用来提取请求的分页请求信息和返回数据的分页响应信息"},compProps:({form:t})=>({text:!0,type:t.pageableAdapterConfigJson?"primary":"default",buttonText:"点击配置",method:()=>{e.value&&(e.value.reactiveData.pageableAdapterConfig.dialogVisible=!0)}})}}),B=(e,{tips:a=""}={})=>({field:{name:"cacheConfigJson"},element:{comp:"PtButton",formItemProps:{label:"缓存配置",tips:a||"用来配置缓存信息，仅在开启缓存后生效"},compProps:({form:t})=>({text:!0,type:t.cacheConfigJson?"primary":"default",buttonText:"点击配置",method:()=>{e.value&&(e.value.reactiveData.cacheConfig.dialogVisible=!0)}})}}),R=[{field:{name:"code"},element:{comp:"el-input",formItemProps:{label:"编码"},compProps:{clearable:!0,placeholder:"模糊匹配"}}},{field:{name:"name"},element:{comp:"el-input",formItemProps:{label:"名称"},compProps:{clearable:!0,placeholder:"模糊匹配"}}},{field:{name:"categoryDictId"},element:{comp:"PtDictFrontSelect",formItemProps:{label:"分类"},compProps:{dictParam:{groupCode:"dataquery_datasource_api_category"}}}},d({}),{field:{name:"dataQueryDatasourceId"},element:{comp:"PtSelect",formItemProps:{label:"数据查询数据源"},compProps:{dataMethod:c}}},{field:{name:"responseTypeDictId"},element:{comp:"PtDictFrontSelect",formItemProps:{label:"输出包装类型"},compProps:{dictParam:{groupCode:"dataquery_datasource_api_type"}}}},{field:{name:"inParamTypeDictId"},element:{comp:"PtDictFrontSelect",formItemProps:{label:"入参类型"},compProps:{dictParam:{groupCode:"dataquery_datasource_api_param_type"}}}},{field:{name:"outParamTypeDictId"},element:{comp:"PtDictFrontSelect",formItemProps:{label:"出参类型"},compProps:{dictParam:{groupCode:"dataquery_datasource_api_param_type"}}}},{field:{name:"configJson"},element:{comp:"el-input",formItemProps:{label:"基础配置"},compProps:{clearable:!0,placeholder:"模糊匹配"}}},{field:{name:"sameTag"},element:{comp:"el-input",formItemProps:{label:"等同标签"},compProps:{clearable:!0}}}],j=({form:e,formData:a,dataQueryDatasourceApiFormItemConfigsRef:t,dataQueryDatasourceApiFormItemBasicConfigsRef:l,addSingleDirectElements:P=!1,addPublished:f=!1})=>{let p=[];P&&(p=[{field:{name:"isAddSingleDirect",value:!1},element:{comp:"el-switch",formItemProps:{label:"添加一对一直连数据查询接口"},compProps:{activeText:"添加",inactiveText:"不添加"}}},{field:{name:"dataQueryDataApiUrl"},element:{comp:"el-input",formItemProps:{label:"数据查询接口地址",required:({form:n})=>n.isAddSingleDirect,tips:"请以 / 开头,前端调用地址需要前面拼接 /api/dq。开放接口前面拼接 /openapi/dq"},compProps:{clearable:!0,placeholder:"接口地址，唯一"}}}]);let m=[];return f&&(m=[{field:{name:"isPublished",value:!1},element:{comp:"el-switch",formItemProps:{label:"是否发布",tips:"发布后将不能修改和删除"},compProps:({form:n})=>({disabled:!n.isMaster&&!n.isPublished,disabledReason:!n.isMaster&&!n.isPublished?"dev不允许发布":void 0,activeText:"发布",inactiveText:"不发布"})}}]),[{field:{name:"code"},element:{comp:"el-input",formItemProps:{label:"编码",tips:"为接口定义一个编码，建议符合变量命名规划,如要修改并提交至master请以 __dev 结尾"},compProps:{placeholder:"编码，唯一",clearable:!0}}},{field:{name:"name"},element:{comp:"el-input",formItemProps:{label:"名称",required:!0,tips:"接口名称，任意输入，代表一个可人眼识别的字符串,如要修改并提交至master请以 __dev 结尾"},compProps:{clearable:!0}}},{field:{name:"categoryDictId"},element:{comp:"PtDictFrontSelect",formItemProps:{label:"分类",required:!0,tips:"仅做分类使用，方便归类查询"},compProps:{dictParam:{groupCode:"dataquery_datasource_api_category"}}}},d({required:!0,tips:"数据查询供应商和数据源没有做强关联，请保持和数据源对应的供应商一致"}),{field:{name:"dataQueryDatasourceId"},element:{comp:"PtSelect",formItemProps:{label:"数据查询数据源",required:!0,tips:"数据查询供应商和数据源没有做强关联，请保持和数据查询供应商对应的供应商一致"},compProps:{dataMethod:c}}},{field:{name:"responseTypeDictId"},element:{comp:"PtDictFrontSelect",formItemProps:{label:"输出包装类型",tips:"重要，标识接口数据的输出类型和处理逻辑，表示最终输出的结果数据结构类型，是在出参类型的基础上的二次包装，其中【代理响应数据接口】表示不包装",required:!0},compProps:({form:n,formData:s})=>({disabled:!n.dataQueryDatasourceId,disabledReason:"请先选择数据源",title:"请先选择数据源",dictParam:{groupCode:"dataquery_datasource_api_type"}})}},{field:{name:"dataQueryProviderDocLinkUrl"},element:{comp:"el-input",formItemProps:{label:"文档链接",displayBlock:!0,tips:"如果对接是第三方，可能会提供参考地址，须以http开头的绝对路径"},compProps:{placeholder:"如：http(s)://xxx.com/xxx/api",clearable:!0}}},{field:{name:"inParamTypeDictId"},element:{comp:"PtDictFrontSelect",formItemProps:{label:"入参类型",tips:"不选择则表示无入参,须和基础配置中的使用保持一致，该类型可以向上追溯到接口测试、数据查询入参保持一致，查询字符串仅表示入参使用 queryString查询，一般仅对接的http请求支持"},compProps:{dictParam:{groupCode:"dataquery_datasource_api_param_type"}}}},y(t),T(t),J(t),_(t),I(t),{field:{name:"outParamTypeDictId"},element:{comp:"PtDictFrontSelect",formItemProps:{label:"出参类型",required:!0,tips:"表示在调用基础配置接口或本地方法后返回的结果的理想类型，该值仅是一个参考值，最终返回类型是结合基础配置接口和本类型综合适配得出"},compProps:{dictParam:{groupCode:"dataquery_datasource_api_param_type"}}}},C(t),D(t),S(t),V(t),q(t),{field:{name:"configJson"},element:{comp:"PtButton",formItemProps:{label:"基础配置",tips:"具体的执行内容配置",required:!0},compProps:({form:n})=>({text:!0,type:n.configJson?"primary":"default",buttonText:"点击配置",beforeMethod:()=>n.dataQueryDatasourceId?!0:"请先选择数据源",method:()=>{let s={datasource_jdbc(){l.value&&(l.value.reactiveData.jdbc.dialogVisible=!0)},datasource_http(){l.value&&(l.value.reactiveData.http.dialogVisible=!0)},datasource_neo4j(){l.value&&(l.value.reactiveData.neo4j.dialogVisible=!0)},datasource_es(){l.value&&(l.value.reactiveData.es.dialogVisible=!0)}},u=a.dataQueryDatasourceId.typeDictValue;(s[u]||(()=>{let b=a.dataQueryDatasourceId.name,g=a.dataQueryDatasourceId.typeDictName;h(`选择的数据源 ${b} 类型为 ${g} 暂不支持配置`,"error")}))()}})}},E(t),M(t),{field:{name:"rateLimitControlConfigJson"},element:{comp:"el-input",formItemProps:{label:"流量控制配置",tips:"对三方接口可能有调用频次限制时进行配置，一般为QPS"},compProps:{clearable:!0}}},{field:{name:"circuitBreakerControlConfigJson"},element:{comp:"el-input",formItemProps:{label:"熔断控制配置",tips:"可对调用的接口在不稳定时进行熔断处理规则配置"},compProps:{clearable:!0}}},{field:{name:"connectTimeout",value:1e3},element:{comp:"el-input-number",formItemProps:{label:"连接等待时间",tips:"单位：ms。0为不限制，在存在有连接参数的调用时可用如：http调用"},compProps:{}}},{field:{name:"readTimeout",value:6e3},element:{comp:"el-input-number",formItemProps:{label:"读取等待时间",tips:"单位：ms。0为不限制，在接口调用时超过该值将丢弃"},compProps:{}}},{field:{name:"isUseCache",value:!1},element:{comp:"el-switch",formItemProps:{label:"是否使用缓存",tips:"缓存时间不支持自定义",labelTips:"参考实现：com.particle.global.cache.CacheHelper"},compProps:{activeText:"使用缓存",inactiveText:"不使用缓存"}}},B(t),{field:{name:"sameTag"},element:{comp:"el-input",formItemProps:{label:"等同标签",tips:"一个字符串，用来标识相同入参出参的接口"},compProps:{clearable:!0}}},{field:{name:"isSupportTrans",value:!1},element:{comp:"el-switch",formItemProps:{label:"翻译支持",tips:"提供翻译数据支持，必须入参为数组，出参为数组，不能设置包装类型，出参数组项必须包含要翻译的键和值字段，设置不当可能翻译不出数据或出现运行时错误！！，仅对批量翻译提供支持"},compProps:{activeText:"支持",inactiveText:"不支持"}}},...m,{field:{name:"remark"},element:{comp:"el-input",formItemProps:{label:"描述"},compProps:{clearable:!0}}},...p]},ee=j;export{V as A,q as B,E as C,M as D,Z as a,K as b,H as c,G as d,L as e,O as f,$ as g,i as h,ee as i,W as j,X as k,F as l,Q as m,A as n,Y as o,R as p,y as q,z as r,T as s,J as t,j as u,_ as v,I as w,C as x,D as y,S as z};
