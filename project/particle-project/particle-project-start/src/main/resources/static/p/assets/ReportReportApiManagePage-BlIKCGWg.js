import{p as P,a as T,r as x,b as A}from"./reportReportApiManage-CHovqAU4.js";import{d as C,r as f,a as B,b as r,o as O,c as M,e as a,w as l,f as D,F}from"./index-COCB7OXO.js";import"./reportSegmentTemplateCompItem-CsokErIm.js";import"./reportSegmentTemplateAdminApi-Ce2MyIBU.js";import"./treeQueryComps-CWIG2rsy.js";const E=C({__name:"ReportReportApiManagePage",setup(k){const d=f(null),p=B({form:{},formComps:P,tableColumns:[{prop:"name",label:"名称",showOverflowTooltip:!0},{prop:"code",label:"编码",showOverflowTooltip:!0},{prop:"isGroup",label:"分组/接口",formatter:(e,o,n,i)=>n?"分组":"接口"},{prop:"permissions",label:"接口权限码",showOverflowTooltip:!0},{prop:"url",label:"接口地址",showOverflowTooltip:!0},{prop:"reportSegmentTemplateName",label:"报告片段模板",showOverflowTooltip:!0},{prop:"inParamExampleConfigJson",label:"入参示例",showOverflowTooltip:!0},{label:"父级",prop:"parentName",showOverflowTooltip:!0},{prop:"remark",label:"描述",showOverflowTooltip:!0}]}),s=f({buttonText:"查询",loading:!1,permission:"admin:web:reportReportApi:pageQuery"}),c=()=>{d.value.refreshData()},b=({pageQuery:e})=>T({...p.form,...e}),w={permission:s.value.permission},h=({row:e,column:o,$index:n})=>n<0?[]:[{txt:"编辑",text:!0,permission:"admin:web:reportReportApi:update",route:{path:"/admin/ReportReportApiManageUpdate",query:{id:e.id}}},{txt:"删除",text:!0,position:"more",permission:"admin:web:reportReportApi:delete",methodConfirmText:`确定要删除 ${e.name} 吗？`,method(){return x({id:e.id}).then(t=>(c(),Promise.resolve(t)))}},{txt:"刷新缓存",text:!0,position:"more",permission:"admin:web:reportReportApi:refreshCache",methodSuccess:t=>"刷新缓存成功,如果部署多个实例可能要多次执行。 "+t.data.data,method(){return A({url:e.url,isIncludeSegmentTemplate:!0}).then(t=>Promise.resolve(t))}}];return(e,o)=>{const n=r("PtButton"),i=r("PtForm"),m=r("PtButtonGroup"),t=r("el-table-column"),_=r("PtTable"),v=r("PtRouteViewPopover");return O(),M(F,null,[a(i,{form:p.form,method:c,labelWidth:"100",defaultButtonsShow:"submit,reset",submitAttrs:s.value,inline:"",comps:p.formComps},{buttons:l(()=>[a(n,{permission:"admin:web:reportReportApi:create",route:"/admin/ReportReportApiManageAdd"},{default:l(()=>o[1]||(o[1]=[D("添加")])),_:1})]),_:1},8,["form","submitAttrs","comps"]),a(_,{ref_key:"tableRef",ref:d,"default-expand-all":"",dataMethod:b,onDataMethodDataLoading:o[0]||(o[0]=u=>s.value.loading=u),dataMethodResultHandleConvertToTree:!0,paginationProps:w,columns:p.tableColumns},{defaultAppend:l(()=>[a(t,{label:"操作",width:"180"},{default:l(({row:u,column:R,$index:g})=>[a(m,{options:h({row:u,column:R,$index:g}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),a(v,{level:3})],64)}}});export{E as default};
