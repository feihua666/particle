import{p as I,r as V,a as q}from"./lowcodeSegmentGenAdminApi-ClJfFAaR.js";import{d as $,r as R,a as F,b as n,o as L,c as j,e as a,w as c,f as U,F as K,R as C}from"./index-DY8PGGNe.js";import{p as Q}from"./lowcodeSegmentGenManage-Dxej3wW3.js";import"./lowcodeSegmentTemplateAdminApi-DT25UfKB.js";import"./lowcodeModelAdminApi-CXKLs32N.js";const ee=$({__name:"LowcodeSegmentGenManagePage",setup(W){const P=R(null),m=F({form:{},formComps:Q,tableColumns:[{label:"生成名称",prop:"name"},{label:"片段模板名称",prop:"lowcodeSegmentTemplateName"},{label:"模型名称",prop:"lowcodeModelName"},{label:"模型数据",prop:"lowcodeModelJson",showOverflowTooltip:!0},{label:"全局数据(渲染后有值)",prop:"globalJson",showOverflowTooltip:!0},{label:"扩展数据(渲染后有值)",prop:"extJson",showOverflowTooltip:!0},{label:"输出绝对位置(渲染后有值)",prop:"outputFileParentAbsoluteDir",showOverflowTooltip:!0},{label:"java包key(渲染后有值)",prop:"javaPackageKeys",showOverflowTooltip:!0},{label:"是否生成",prop:"isGenerated"},{label:"生成类型",prop:"generateTypeDictName"},{label:"引用生成名称",prop:"refrenceSegmentGenName"},{label:"描述",prop:"remark",showOverflowTooltip:!0}]}),g=R({buttonText:"查询",loading:!1,permission:"admin:web:lowcodeSegmentGen:pageQuery"}),b=()=>{P.value.refreshData()},J=({pageQuery:e})=>I({...m.form,...e}),k={permission:g.value.permission},B=({row:e,column:r,$index:f})=>{var S,v,y,M,T,E,D,A;if(f<0)return[];let d={id:e.id},l={id:e.id,refrenceSegmentGenId:e.refrenceSegmentGenId,isGenerated:e.isGenerated},t=[{txt:"编辑",text:!0,permission:"admin:web:lowcodeSegmentGen:update",route:{path:"/admin/lowcodeSegmentGenManageUpdate",query:d}},{txt:"删除",text:!0,position:"more",permission:"admin:web:lowcodeSegmentGen:delete",methodConfirmText:`确定要删除 ${e.name} 吗？`,method(){return V(d).then(h=>(b(),Promise.resolve(h)))}},{txt:"重新加载模型json数据",text:!0,position:"more",permission:"admin:web:lowcodeSegmentGen:reloadLowcodeModelJson",methodConfirmText:`这将会覆盖当前的模型json数据，确定要重新加载 ${e.name} 吗？`,method(){return q(d).then(h=>(b(),Promise.resolve(h)))}}];const s=C(e.generateTypeDictValue,["backend_module","frontend_module","backend_and_frontend_module"]);s&&t.push({txt:"模块设计和渲染",text:!0,position:"more",permission:"admin:web:lowcodeSegmentGen:renderGen",route:{path:"/admin/lowcodeSegmentGenModuleDesignAndGenerate",query:l}});const p=C(e.generateTypeDictValue,["backend_model_service","frontend_model_service","backend_and_frontend_model_service"]);p&&t.push({txt:"模型服务设计和渲染",text:!0,position:"more",beforeMethod:()=>e.lowcodeModelId>0?!0:"模型服务设计与渲染需要设置模型",permission:"admin:web:lowcodeSegmentGen:renderGen",route:{path:"/admin/lowcodeSegmentGenModelServiceDesignAndGenerate",query:l}}),!s&&!p&&t.push({txt:"通用设计和渲染",text:!0,position:"more",permission:"admin:web:lowcodeSegmentGen:renderGen",route:{path:"/admin/lowcodeSegmentGenGenericDesignAndGenerate",query:l}});let i=e.globalJson,u=JSON.parse(i)||{},_=e.lowcodeModelJson,o=JSON.parse(_)||{},N=u.moduleNamePackage+"_manage",w=e.name.split("_")[0]+"管理",G="1",x=u.moduleName;t.push({txt:"添加根功能菜单",text:!0,position:"more",disabled:!e.isGenerated,disabledReason:e.isGenerated?void 0:"生成后才可以添加根功能菜单",permission:"admin:web:func:create",route:{path:"/admin/lowcodeSegmentGen_funcManageAdd",query:{code:N,name:w,funcGroupId:G,typeDictId:"21",componentOf:x}}});let O=((S=o.model)==null?void 0:S.nameEn)+"_manage_page";return t.push({txt:"添加功能菜单页面",text:!0,position:"more",disabled:!e.isGenerated,disabledReason:e.isGenerated?void 0:"生成后才可以添加功能菜单页面",permission:"admin:web:func:create",route:{path:"/admin/lowcodeSegmentGen_funcManageAdd",query:{code:O,name:w,funcGroupId:G,typeDictId:"22",url:`/admin/${(v=o.model)==null?void 0:v.nameEnEntityVar}ManagePage`,componentOf:x}}}),t.push({txt:"添加功能菜单页面CRUD",text:!0,position:"more",disabled:!e.isGenerated,disabledReason:e.isGenerated?void 0:"生成后才可以添加功能菜单页面CRUD",permission:"admin:web:func:create",route:{path:"/admin/lowcodeSegmentGen_funcManageCrudAdd",query:{codePrefix:((y=o.model)==null?void 0:y.nameEn)+"_manage_page_",namePrefix:w,permissionPrefix:`admin:web:${(M=o.model)==null?void 0:M.nameEnEntityVar}:`,funcGroupId:G,typeDictId:"1605497232817737729",componentOf:x,createExtPermission:`admin${(T=o.model)==null?void 0:T.nameEnEntity}ManageAdd`,updateExtPermission:`admin${(E=o.model)==null?void 0:E.nameEnEntity}ManageUpdate`,queryPageExtPermission:`admin${(D=o.model)==null?void 0:D.nameEnEntity}ManagePage`,isTree:((A=o.model)==null?void 0:A.tableTypeDictValue)=="TREE"}}}),t};return(e,r)=>{const f=n("PtButton"),d=n("PtForm"),l=n("PtButtonGroup"),t=n("el-table-column"),s=n("PtTable"),p=n("PtRouteViewPopover");return L(),j(K,null,[a(d,{form:m.form,method:b,defaultButtonsShow:"submit,reset",submitAttrs:g.value,inline:"",comps:m.formComps},{buttons:c(()=>[a(f,{permission:"admin:web:lowcodeSegmentGen:create",route:"/admin/lowcodeSegmentGenManageAdd"},{default:c(()=>r[1]||(r[1]=[U("添加")])),_:1})]),_:1},8,["form","submitAttrs","comps"]),a(s,{ref_key:"tableRef",ref:P,"default-expand-all":"",dataMethod:J,onDataMethodDataLoading:r[0]||(r[0]=i=>g.value.loading=i),paginationProps:k,columns:m.tableColumns},{defaultAppend:c(()=>[a(t,{label:"操作",width:"180"},{default:c(({row:i,column:u,$index:_})=>[a(l,{options:B({row:i,column:u,$index:_}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),a(p,{level:3})],64)}}});export{ee as default};
