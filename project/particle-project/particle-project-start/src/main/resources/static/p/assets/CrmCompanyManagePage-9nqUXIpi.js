import{p as v,r as w}from"./crmCompItem-CDH2YjkP.js";import{p as h}from"./crmCompanyManage-AgdqGf5_.js";import{d as B,r as b,a as T,b as t,o as M,c as R,e as o,w as m,f as A,F as D}from"./index-BIT85eDf.js";import"./crmCustomerTagAdminApi-C5lwXNzL.js";import"./treeQueryComps-CWIG2rsy.js";const S=B({__name:"CrmCompanyManagePage",setup(F){const u=b(null),a=T({form:{},formComps:h,tableColumns:[{prop:"name",label:"公司名称"},{prop:"code",label:"公司编码"},{prop:"nameSimple",label:"公司简称名称"},{prop:"parentName",label:"父级"},{prop:"seq",label:"排序"},{prop:"remark",label:"备注"}]}),s=b({buttonText:"查询",loading:!1,permission:"admin:web:crmCompany:pageQuery"}),d=()=>{u.value.refreshData()},f=({pageQuery:e})=>v({...a.form,...e}),C={permission:s.value.permission},_=({row:e,column:n,$index:p})=>{if(p<0)return[];let r={id:e.id};return[{txt:"添加子级",text:!0,permission:"admin:web:crmCompany:create",route:{path:"/admin/CrmCompanyManageAdd",query:r}},{txt:"编辑",text:!0,position:"more",permission:"admin:web:crmCompany:update",route:{path:"/admin/CrmCompanyManageUpdate",query:r}},{txt:"删除",text:!0,position:"more",permission:"admin:web:crmCompany:delete",methodConfirmText:`确定要删除 ${e.name} 吗？`,method(){return w({id:e.id}).then(l=>(d(),Promise.resolve(l)))}}]};return(e,n)=>{const p=t("PtButton"),r=t("PtForm"),c=t("PtButtonGroup"),l=t("el-table-column"),g=t("PtTable"),P=t("PtRouteViewPopover");return M(),R(D,null,[o(r,{form:a.form,method:d,defaultButtonsShow:"submit,reset",submitAttrs:s.value,inline:"",comps:a.formComps},{buttons:m(()=>[o(p,{permission:"admin:web:crmCompany:create",route:"/admin/CrmCompanyManageAdd"},{default:m(()=>n[1]||(n[1]=[A("添加")])),_:1})]),_:1},8,["form","submitAttrs","comps"]),o(g,{ref_key:"tableRef",ref:u,"default-expand-all":"",dataMethod:f,onDataMethodDataLoading:n[0]||(n[0]=i=>s.value.loading=i),dataMethodResultHandleConvertToTree:!0,paginationProps:C,columns:a.tableColumns},{defaultAppend:m(()=>[o(l,{label:"操作",width:"180"},{default:m(({row:i,column:x,$index:y})=>[o(c,{options:_({row:i,column:x,$index:y}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),o(P,{level:3})],64)}}});export{S as default};
