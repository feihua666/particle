import{p as T,r as P,a as x}from"./reportReportApiAdminApi-D-0ZmUPu.js";import{p as A}from"./reportReportApiManage-Dx7w7skJ.js";import{d as C,r as c,a as B,b as r,o as O,c as M,e as a,w as l,f as D,F}from"./index-DMP92Tz2.js";import"./reportSegmentTemplateCompItem-Dleg1CNR.js";import"./reportSegmentTemplateAdminApi-BEv29G4e.js";import"./treeQueryComps-CWIG2rsy.js";const E=C({__name:"ReportReportApiManagePage",setup(k){const d=c(null),s=B({form:{},formComps:A,tableColumns:[{prop:"name",label:"名称",showOverflowTooltip:!0},{prop:"code",label:"编码",showOverflowTooltip:!0},{prop:"isGroup",label:"分组/接口",formatter:(e,o,n,p)=>n?"分组":"接口"},{prop:"permissions",label:"接口权限码",showOverflowTooltip:!0},{prop:"url",label:"接口地址",showOverflowTooltip:!0},{prop:"reportSegmentTemplateName",label:"报告片段模板",showOverflowTooltip:!0},{prop:"inParamExampleConfigJson",label:"入参示例",showOverflowTooltip:!0},{label:"父级",prop:"parentName",showOverflowTooltip:!0},{prop:"remark",label:"描述",showOverflowTooltip:!0}]}),i=c({buttonText:"查询",loading:!1,permission:"admin:web:reportReportApi:pageQuery"}),f=()=>{d.value.refreshData()},b=({pageQuery:e})=>T({...s.form,...e}),w={permission:i.value.permission},h=({row:e,column:o,$index:n})=>{if(n<0)return[];let p={id:e.id};return[{txt:"接口测试",text:!0,permission:"admin:web:reportReportApi:test",route:{path:"/admin/reportReportApiManageTest",query:p}},{txt:"编辑",text:!0,position:"more",permission:"admin:web:reportReportApi:update",route:{path:"/admin/ReportReportApiManageUpdate",query:p}},{txt:"删除",text:!0,position:"more",permission:"admin:web:reportReportApi:delete",methodConfirmText:`确定要删除 ${e.name} 吗？`,method(){return P({id:e.id}).then(t=>(f(),Promise.resolve(t)))}},{txt:"刷新缓存",text:!0,position:"more",permission:"admin:web:reportReportApi:refreshCache",methodSuccess:t=>"刷新缓存成功,如果部署多个实例可能要多次执行。 "+t.data.data,method(){return x({url:e.url,isIncludeSegmentTemplate:!0}).then(t=>Promise.resolve(t))}}]};return(e,o)=>{const n=r("PtButton"),p=r("PtForm"),m=r("PtButtonGroup"),t=r("el-table-column"),R=r("PtTable"),_=r("PtRouteViewPopover");return O(),M(F,null,[a(p,{form:s.form,method:f,labelWidth:"100",defaultButtonsShow:"submit,reset",submitAttrs:i.value,inline:"",comps:s.formComps},{buttons:l(()=>[a(n,{permission:"admin:web:reportReportApi:create",route:"/admin/ReportReportApiManageAdd"},{default:l(()=>o[1]||(o[1]=[D("添加")])),_:1})]),_:1},8,["form","submitAttrs","comps"]),a(R,{ref_key:"tableRef",ref:d,"default-expand-all":"",dataMethod:b,onDataMethodDataLoading:o[0]||(o[0]=u=>i.value.loading=u),dataMethodResultHandleConvertToTree:!0,paginationProps:w,columns:s.tableColumns},{defaultAppend:l(()=>[a(t,{label:"操作",width:"180"},{default:l(({row:u,column:v,$index:g})=>[a(m,{options:h({row:u,column:v,$index:g}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),a(_,{level:3})],64)}}});export{E as default};
