import{e as v,f as w}from"./crmCompItem-DDwuFJdh.js";import{p as h}from"./crmDeptManage-BamiC4p1.js";import{d as B,r as b,a as T,b as t,o as M,c as R,e as o,w as m,f as A,F as y}from"./index-DY8PGGNe.js";import"./crmCustomerTagAdminApi-CAeI7pTa.js";import"./treeQueryComps-CWIG2rsy.js";const E=B({__name:"CrmDeptManagePage",setup(F){const u=b(null),a=T({form:{},formComps:h,tableColumns:[{prop:"name",label:"部门名称"},{prop:"code",label:"部门编码"},{prop:"crmCompanyName",label:"公司名称"},{prop:"parentName",label:"父级"},{prop:"seq",label:"排序"},{prop:"remark",label:"备注"}]}),s=b({buttonText:"查询",loading:!1,permission:"admin:web:crmDept:pageQuery"}),d=()=>{u.value.refreshData()},f=({pageQuery:e})=>v({...a.form,...e}),_={permission:s.value.permission},g=({row:e,column:n,$index:p})=>{if(p<0)return[];let r={id:e.id};return[{txt:"添加子级",text:!0,permission:"admin:web:crmDept:create",route:{path:"/admin/CrmDeptManageAdd",query:r}},{txt:"编辑",text:!0,position:"more",permission:"admin:web:crmDept:update",route:{path:"/admin/CrmDeptManageUpdate",query:r}},{txt:"删除",text:!0,position:"more",permission:"admin:web:crmDept:delete",methodConfirmText:`确定要删除 ${e.name} 吗？`,method(){return w({id:e.id}).then(l=>(d(),Promise.resolve(l)))}}]};return(e,n)=>{const p=t("PtButton"),r=t("PtForm"),c=t("PtButtonGroup"),l=t("el-table-column"),P=t("PtTable"),x=t("PtRouteViewPopover");return M(),R(y,null,[o(r,{form:a.form,method:d,defaultButtonsShow:"submit,reset",submitAttrs:s.value,inline:"",comps:a.formComps},{buttons:m(()=>[o(p,{permission:"admin:web:crmDept:create",route:"/admin/CrmDeptManageAdd"},{default:m(()=>n[1]||(n[1]=[A("添加")])),_:1})]),_:1},8,["form","submitAttrs","comps"]),o(P,{ref_key:"tableRef",ref:u,"default-expand-all":"",dataMethod:f,onDataMethodDataLoading:n[0]||(n[0]=i=>s.value.loading=i),dataMethodResultHandleConvertToTree:!0,paginationProps:_,columns:a.tableColumns},{defaultAppend:m(()=>[o(l,{label:"操作",width:"180"},{default:m(({row:i,column:C,$index:D})=>[o(c,{options:g({row:i,column:C,$index:D}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),o(x,{level:3})],64)}}});export{E as default};
