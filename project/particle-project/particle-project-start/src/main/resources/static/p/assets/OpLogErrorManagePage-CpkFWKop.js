import{k as w,d as O,r as f,a as x,b as o,o as B,c as q,e as t,w as b,F as C}from"./index-DMP92Tz2.js";let P="/admin/web/op_log_error";const A=r=>w.delete(P+"/delete",{data:r}),E=r=>w.get(P+"/page",{params:r}),k=[{field:{name:"traceId"},element:{comp:"el-input",formItemProps:{label:"traceId"},compProps:{}}},{field:{name:"userId"},element:{comp:"el-input",formItemProps:{label:"操作用户id"},compProps:{}}},{field:{name:"userName"},element:{comp:"el-input",formItemProps:{label:"操作用户姓名"},compProps:{clearable:!0,placeholder:"左前缀匹配"}}},{field:{name:"userNickname"},element:{comp:"el-input",formItemProps:{label:"操作用户昵称"},compProps:{clearable:!0,placeholder:"左前缀匹配"}}},{field:{name:"requestUrl"},element:{comp:"el-input",formItemProps:{label:"请求地址"},compProps:{clearable:!0,placeholder:"左前缀匹配"}}},{field:{name:"requestMethod"},element:{comp:"el-input",formItemProps:{label:"请求方法"},compProps:{clearable:!0}}},{field:{name:"requestIp"},element:{comp:"el-input",formItemProps:{label:"请求ip"},compProps:{clearable:!0}}},{field:{name:"responseStatus"},element:{comp:"el-input",formItemProps:{label:"响应的状态码"},compProps:{clearable:!0}}},{field:{name:"localHostIp"},element:{comp:"el-input",formItemProps:{label:"本地主机ip"},compProps:{clearable:!0}}},{field:{name:"localHostName"},element:{comp:"el-input",formItemProps:{label:"本地主机名称"},compProps:{clearable:!0}}},{field:{name:"errorAtStart"},element:{comp:"PtDatePicker",formItemProps:{label:"异常发生时间开始"},compProps:{type:"datetime"}}},{field:{name:"errorAtEnd"},element:{comp:"PtDatePicker",formItemProps:{label:"异常发生时间结束"},compProps:{type:"datetime"}}}],L=O({__name:"OpLogErrorManagePage",setup(r){const i=f(null),l=x({form:{},formComps:k,tableColumns:[{prop:"traceId",label:"traceId",showOverflowTooltip:!0},{prop:"userId",label:"用户id",showOverflowTooltip:!0},{prop:"userName",label:"用户姓名",showOverflowTooltip:!0},{prop:"userNickname",label:"用户昵称",showOverflowTooltip:!0},{prop:"userAvatar",label:"用户头像",showOverflowTooltip:!0},{prop:"requestUrl",label:"请求地址",showOverflowTooltip:!0},{prop:"requestMethod",label:"请求方法",showOverflowTooltip:!0},{prop:"requestHeaders",label:"请求头信息",showOverflowTooltip:!0},{prop:"requestParams",label:"请求参数",showOverflowTooltip:!0},{prop:"requestBody",label:"请求内容",showOverflowTooltip:!0},{prop:"requestIp",label:"请求ip",showOverflowTooltip:!0},{prop:"responseStatus",label:"响应状态码",showOverflowTooltip:!0},{prop:"responseHeaders",label:"响应头信息",showOverflowTooltip:!0},{prop:"responseBody",label:"响应内容",showOverflowTooltip:!0},{prop:"localHostIp",label:"本地主机ip",showOverflowTooltip:!0},{prop:"localHostName",label:"本地主机名称",showOverflowTooltip:!0},{prop:"errorAt",label:"异常发生时间",showOverflowTooltip:!0}]}),p=f({buttonText:"查询",loading:!1,permission:"admin:web:opLogError:pageQuery"}),u=()=>{i.value.refreshData()},h=({pageQuery:e})=>E({...l.form,...e}),v={permission:p.value.permission},g=({row:e,column:a,$index:s})=>s<0?[]:[{txt:"查看异常内容",text:!0,permission:"admin:web:opLogErrorContent:detail",route:{path:"/admin/OpLogErrorContentViewPage",query:{id:e.id}}},{txt:"删除",text:!0,position:"more",permission:"admin:web:opLogError:delete",methodConfirmText:`确定要删除 traceId=${e.traceId} 的异常数据吗？`,method(){return A({id:e.id}).then(n=>(u(),Promise.resolve(n)))}}];return(e,a)=>{const s=o("PtForm"),c=o("PtButtonGroup"),d=o("el-table-column"),n=o("PtTable"),I=o("PtRouteViewPopover");return B(),q(C,null,[t(s,{form:l.form,method:u,defaultButtonsShow:"submit,reset",submitAttrs:p.value,inline:"","label-width":"100",comps:l.formComps},null,8,["form","submitAttrs","comps"]),t(n,{ref_key:"tableRef",ref:i,"default-expand-all":"",dataMethod:h,onDataMethodDataLoading:a[0]||(a[0]=m=>p.value.loading=m),paginationProps:v,columns:l.tableColumns},{defaultAppend:b(()=>[t(d,{label:"操作",width:"240"},{default:b(({row:m,column:T,$index:_})=>[t(c,{options:g({row:m,column:T,$index:_}),dropdownTriggerButtonOptions:{text:!0,buttonText:"更多"}},null,8,["options"])]),_:1})]),_:1},8,["columns"]),t(I,{level:3})],64)}}});export{L as default};
